/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "../../../../node_modules/@rynpsc/dialog/dist/module/dialog.js":
/*!*********************************************************************!*\
  !*** ../../../../node_modules/@rynpsc/dialog/dist/module/dialog.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"dialog\": () => (/* binding */ m),\n/* harmony export */   \"domapi\": () => (/* binding */ u),\n/* harmony export */   \"getInstanceById\": () => (/* binding */ f),\n/* harmony export */   \"instances\": () => (/* binding */ s)\n/* harmony export */ });\nconst e=[\"input\",\"select\",\"textarea\",\"button\",\"summary\",\"a[href]\",\"area[href]\",\"embed\",\"iframe\",\"object\",\"audio[controls]\",\"video[controls]\",'[contenteditable]:not([contenteditable=\"false\"])'];function t(e,t=!1){\"function\"==typeof e.focus&&e.focus({preventScroll:!t})}function n(e,n=!1){const r=o(e);if(!r.length)return!1;t(r[0],n)}function o(t){return Array.from(t.querySelectorAll(e.join(\",\"))).filter(t=>function(t){let n=parseInt(t.getAttribute(\"tabindex\")||\"\",10);if(t.hidden||n&&n<0||t.matches(\":disabled\")||!t.matches(e.join(\",\"))||r(t)&&!function(e){if(!r(e))return!1;let t=e.form||document;if(!Array.from(t.getElementsByName(e.name)).some(e=>e.checked))return!0;return e.checked}(t)||!function(e){if(0===e.getClientRects().length)return!1;return\"visible\"===window.getComputedStyle(e).visibility}(t))return!1;return!0}(t))}function r(e){return e instanceof HTMLInputElement&&\"radio\"===e.type}let i,a;function l(e){let{currentTarget:t}=e;if(!(t instanceof HTMLElement&&t.dataset.dialogOpen))return;let n=f(t.dataset.dialogOpen);n&&(n.open(),e.preventDefault())}function c(e){let{currentTarget:t}=e;if(!(t instanceof HTMLElement&&t.dataset.dialogClose))return;let n=f(t.dataset.dialogClose);n&&(n.close(),e.preventDefault())}var u=Object.freeze({__proto__:null,get openers(){return i},get closers(){return a},mount:function(){i=Array.from(document.querySelectorAll(\"[data-dialog-open]\")),a=Array.from(document.querySelectorAll(\"[data-dialog-close]\")),i.forEach(e=>e.addEventListener(\"click\",l)),a.forEach(e=>e.addEventListener(\"click\",c))},unmount:function(){i=[],a=[],i.forEach(e=>e.removeEventListener(\"click\",l)),a.forEach(e=>e.removeEventListener(\"click\",c))}});const d={alert:!1,description:void 0,label:\"Dialog\",manageFocus:!0,openClass:\"is-open\"},s={};function f(e){return void 0===e?null:Object.prototype.hasOwnProperty.call(s,e)?s[e]:null}function m(e,r={}){let i,a=!1,l=!1,c=document.getElementById(e);if(!c)return;if(s.hasOwnProperty(e))return s[e];const u=Object.assign({},d,r);function f(e){\"Escape\"===e.key&&v()}function m(e,t=!0){!a&&l&&b(\"open\")&&(a=!0,c.classList.add(u.openClass),document.addEventListener(\"keydown\",f,!0),i&&(void 0===e&&null!==c.querySelector(\"[data-dialog-autofocus]\")&&(e=c.querySelector(\"[data-dialog-autofocus]\")),i.activate(e,t)))}function v(e,t=!0){a&&l&&b(\"close\")&&(i&&i.deactivate(e,t),a=!1,document.removeEventListener(\"keydown\",f,!0),c.classList.remove(u.openClass))}function b(t){let n=new CustomEvent(\"dialog:\"+t,{bubbles:!0,cancelable:!0,detail:{id:e}});return c.dispatchEvent(n)}u.manageFocus&&(i=function(e){let r=!1,i=null,a=null;function l(o){let r=o.target;if(e.contains(r))return o.stopPropagation(),void(i=r);o.preventDefault(),i?t(i,!0):n(e,!0)}function c(n){\"Tab\"!==n.key||n.altKey||n.ctrlKey||n.metaKey||function(e,n){let r=document.activeElement,i=o(e),a=i[0],l=i[i.length-1];n.shiftKey&&r==a?(t(l,!0),n.preventDefault()):n.shiftKey||r!=l||(t(a,!0),n.preventDefault())}(e,n)}return{activated:r,activate:function(o,i=!1){r||(a=document.activeElement,o?t(o,i):null!==o&&n(e,i),document.addEventListener(\"focusin\",l,!1),document.addEventListener(\"keydown\",c,!1),r=!0)},deactivate:function(e,n=!1){if(!r)return;document.removeEventListener(\"focusin\",l,!1),document.removeEventListener(\"keydown\",c,!1);let o=e||(null!==e?a:null);o&&t(o,n),r=!1,i=null}}}(c));const p={close:v,create:function(){if(l)return!1;let e=u.alert?\"alertdialog\":\"dialog\";if(c.setAttribute(\"tabindex\",\"-1\"),c.setAttribute(\"role\",e),c.setAttribute(\"aria-modal\",\"true\"),u.label){let e=document.getElementById(u.label)?\"aria-labelledby\":\"aria-label\";c.setAttribute(e,u.label)}u.description&&document.getElementById(u.description)&&c.setAttribute(\"aria-describedby\",u.description),l=!0,b(\"create\")},destroy:function(){if(!l)return!1;v(),l=!1,[\"role\",\"tabindex\",\"aria-modal\",\"aria-label\",\"aria-labelledby\",\"aria-describedby\"].forEach(e=>c.removeAttribute(e)),b(\"destroy\")},element:c,id:e,initiated:l,get isOpen(){return a},off:function(e,t){let n=\"dialog:\"+e;c.removeEventListener(n,t)},on:function(e,t){let n=\"dialog:\"+e;c.addEventListener(n,t)},open:m,toggle:function(e=!a){e?m():v()}};return s[e]=p}\n//# sourceMappingURL=dialog.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL0ByeW5wc2MvZGlhbG9nL2Rpc3QvbW9kdWxlL2RpYWxvZy5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsaU1BQWlNLG1CQUFtQixxQ0FBcUMsaUJBQWlCLEVBQUUsbUJBQW1CLGFBQWEsc0JBQXNCLFVBQVUsY0FBYyx5RUFBeUUsa0RBQWtELHlGQUF5RixrQkFBa0IsdUJBQXVCLHdFQUF3RSxpQkFBaUIsa0JBQWtCLDBDQUEwQyx3REFBd0QsYUFBYSxTQUFTLEtBQUssY0FBYyx1REFBdUQsUUFBUSxjQUFjLElBQUksZ0JBQWdCLEdBQUcsNERBQTRELDhCQUE4QixpQ0FBaUMsY0FBYyxJQUFJLGdCQUFnQixHQUFHLDZEQUE2RCwrQkFBK0Isa0NBQWtDLHFCQUFxQiw2QkFBNkIsU0FBUyxlQUFlLFNBQVMsa0JBQWtCLHFOQUFxTixvQkFBb0IseUdBQXlHLEVBQUUsU0FBUyw4RUFBOEUsTUFBTSxjQUFjLDJFQUEyRSxpQkFBaUIsRUFBRSw2Q0FBNkMsYUFBYSxtQ0FBbUMsd0JBQXdCLE1BQU0sY0FBYyxzQkFBc0IsbUJBQW1CLG1PQUFtTyxtQkFBbUIsMkhBQTJILGNBQWMsbUNBQW1DLGlDQUFpQyxNQUFNLEVBQUUsMEJBQTBCLDhCQUE4Qix1QkFBdUIsY0FBYyxlQUFlLHNEQUFzRCxxQ0FBcUMsY0FBYyw2REFBNkQsMkRBQTJELDZGQUE2RixNQUFNLE9BQU8sc0NBQXNDLGlKQUFpSiw2QkFBNkIsYUFBYSwwRkFBMEYsMkJBQTJCLHdCQUF3QixLQUFLLFNBQVMsMEJBQTBCLGNBQWMscUNBQXFDLHlHQUF5RyxzRUFBc0UsMEJBQTBCLHlIQUF5SCxvQkFBb0IsZUFBZSwwSUFBMEkseUNBQXlDLFNBQVMsbUJBQW1CLGtCQUFrQiwyQkFBMkIsa0JBQWtCLGtCQUFrQix3QkFBd0IsOEJBQThCLFlBQVksY0FBa0Y7QUFDdm1JIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9AcnlucHNjL2RpYWxvZy9kaXN0L21vZHVsZS9kaWFsb2cuanM/Y2IwNSJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBlPVtcImlucHV0XCIsXCJzZWxlY3RcIixcInRleHRhcmVhXCIsXCJidXR0b25cIixcInN1bW1hcnlcIixcImFbaHJlZl1cIixcImFyZWFbaHJlZl1cIixcImVtYmVkXCIsXCJpZnJhbWVcIixcIm9iamVjdFwiLFwiYXVkaW9bY29udHJvbHNdXCIsXCJ2aWRlb1tjb250cm9sc11cIiwnW2NvbnRlbnRlZGl0YWJsZV06bm90KFtjb250ZW50ZWRpdGFibGU9XCJmYWxzZVwiXSknXTtmdW5jdGlvbiB0KGUsdD0hMSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZS5mb2N1cyYmZS5mb2N1cyh7cHJldmVudFNjcm9sbDohdH0pfWZ1bmN0aW9uIG4oZSxuPSExKXtjb25zdCByPW8oZSk7aWYoIXIubGVuZ3RoKXJldHVybiExO3QoclswXSxuKX1mdW5jdGlvbiBvKHQpe3JldHVybiBBcnJheS5mcm9tKHQucXVlcnlTZWxlY3RvckFsbChlLmpvaW4oXCIsXCIpKSkuZmlsdGVyKHQ9PmZ1bmN0aW9uKHQpe2xldCBuPXBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIil8fFwiXCIsMTApO2lmKHQuaGlkZGVufHxuJiZuPDB8fHQubWF0Y2hlcyhcIjpkaXNhYmxlZFwiKXx8IXQubWF0Y2hlcyhlLmpvaW4oXCIsXCIpKXx8cih0KSYmIWZ1bmN0aW9uKGUpe2lmKCFyKGUpKXJldHVybiExO2xldCB0PWUuZm9ybXx8ZG9jdW1lbnQ7aWYoIUFycmF5LmZyb20odC5nZXRFbGVtZW50c0J5TmFtZShlLm5hbWUpKS5zb21lKGU9PmUuY2hlY2tlZCkpcmV0dXJuITA7cmV0dXJuIGUuY2hlY2tlZH0odCl8fCFmdW5jdGlvbihlKXtpZigwPT09ZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aClyZXR1cm4hMTtyZXR1cm5cInZpc2libGVcIj09PXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGUpLnZpc2liaWxpdHl9KHQpKXJldHVybiExO3JldHVybiEwfSh0KSl9ZnVuY3Rpb24gcihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQmJlwicmFkaW9cIj09PWUudHlwZX1sZXQgaSxhO2Z1bmN0aW9uIGwoZSl7bGV0e2N1cnJlbnRUYXJnZXQ6dH09ZTtpZighKHQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCYmdC5kYXRhc2V0LmRpYWxvZ09wZW4pKXJldHVybjtsZXQgbj1mKHQuZGF0YXNldC5kaWFsb2dPcGVuKTtuJiYobi5vcGVuKCksZS5wcmV2ZW50RGVmYXVsdCgpKX1mdW5jdGlvbiBjKGUpe2xldHtjdXJyZW50VGFyZ2V0OnR9PWU7aWYoISh0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQmJnQuZGF0YXNldC5kaWFsb2dDbG9zZSkpcmV0dXJuO2xldCBuPWYodC5kYXRhc2V0LmRpYWxvZ0Nsb3NlKTtuJiYobi5jbG9zZSgpLGUucHJldmVudERlZmF1bHQoKSl9dmFyIHU9T2JqZWN0LmZyZWV6ZSh7X19wcm90b19fOm51bGwsZ2V0IG9wZW5lcnMoKXtyZXR1cm4gaX0sZ2V0IGNsb3NlcnMoKXtyZXR1cm4gYX0sbW91bnQ6ZnVuY3Rpb24oKXtpPUFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWRpYWxvZy1vcGVuXVwiKSksYT1BcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1kaWFsb2ctY2xvc2VdXCIpKSxpLmZvckVhY2goZT0+ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixsKSksYS5mb3JFYWNoKGU9PmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsYykpfSx1bm1vdW50OmZ1bmN0aW9uKCl7aT1bXSxhPVtdLGkuZm9yRWFjaChlPT5lLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLGwpKSxhLmZvckVhY2goZT0+ZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIixjKSl9fSk7Y29uc3QgZD17YWxlcnQ6ITEsZGVzY3JpcHRpb246dm9pZCAwLGxhYmVsOlwiRGlhbG9nXCIsbWFuYWdlRm9jdXM6ITAsb3BlbkNsYXNzOlwiaXMtb3BlblwifSxzPXt9O2Z1bmN0aW9uIGYoZSl7cmV0dXJuIHZvaWQgMD09PWU/bnVsbDpPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocyxlKT9zW2VdOm51bGx9ZnVuY3Rpb24gbShlLHI9e30pe2xldCBpLGE9ITEsbD0hMSxjPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO2lmKCFjKXJldHVybjtpZihzLmhhc093blByb3BlcnR5KGUpKXJldHVybiBzW2VdO2NvbnN0IHU9T2JqZWN0LmFzc2lnbih7fSxkLHIpO2Z1bmN0aW9uIGYoZSl7XCJFc2NhcGVcIj09PWUua2V5JiZ2KCl9ZnVuY3Rpb24gbShlLHQ9ITApeyFhJiZsJiZiKFwib3BlblwiKSYmKGE9ITAsYy5jbGFzc0xpc3QuYWRkKHUub3BlbkNsYXNzKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLGYsITApLGkmJih2b2lkIDA9PT1lJiZudWxsIT09Yy5xdWVyeVNlbGVjdG9yKFwiW2RhdGEtZGlhbG9nLWF1dG9mb2N1c11cIikmJihlPWMucXVlcnlTZWxlY3RvcihcIltkYXRhLWRpYWxvZy1hdXRvZm9jdXNdXCIpKSxpLmFjdGl2YXRlKGUsdCkpKX1mdW5jdGlvbiB2KGUsdD0hMCl7YSYmbCYmYihcImNsb3NlXCIpJiYoaSYmaS5kZWFjdGl2YXRlKGUsdCksYT0hMSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLGYsITApLGMuY2xhc3NMaXN0LnJlbW92ZSh1Lm9wZW5DbGFzcykpfWZ1bmN0aW9uIGIodCl7bGV0IG49bmV3IEN1c3RvbUV2ZW50KFwiZGlhbG9nOlwiK3Qse2J1YmJsZXM6ITAsY2FuY2VsYWJsZTohMCxkZXRhaWw6e2lkOmV9fSk7cmV0dXJuIGMuZGlzcGF0Y2hFdmVudChuKX11Lm1hbmFnZUZvY3VzJiYoaT1mdW5jdGlvbihlKXtsZXQgcj0hMSxpPW51bGwsYT1udWxsO2Z1bmN0aW9uIGwobyl7bGV0IHI9by50YXJnZXQ7aWYoZS5jb250YWlucyhyKSlyZXR1cm4gby5zdG9wUHJvcGFnYXRpb24oKSx2b2lkKGk9cik7by5wcmV2ZW50RGVmYXVsdCgpLGk/dChpLCEwKTpuKGUsITApfWZ1bmN0aW9uIGMobil7XCJUYWJcIiE9PW4ua2V5fHxuLmFsdEtleXx8bi5jdHJsS2V5fHxuLm1ldGFLZXl8fGZ1bmN0aW9uKGUsbil7bGV0IHI9ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCxpPW8oZSksYT1pWzBdLGw9aVtpLmxlbmd0aC0xXTtuLnNoaWZ0S2V5JiZyPT1hPyh0KGwsITApLG4ucHJldmVudERlZmF1bHQoKSk6bi5zaGlmdEtleXx8ciE9bHx8KHQoYSwhMCksbi5wcmV2ZW50RGVmYXVsdCgpKX0oZSxuKX1yZXR1cm57YWN0aXZhdGVkOnIsYWN0aXZhdGU6ZnVuY3Rpb24obyxpPSExKXtyfHwoYT1kb2N1bWVudC5hY3RpdmVFbGVtZW50LG8/dChvLGkpOm51bGwhPT1vJiZuKGUsaSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzaW5cIixsLCExKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLGMsITEpLHI9ITApfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKGUsbj0hMSl7aWYoIXIpcmV0dXJuO2RvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmb2N1c2luXCIsbCwhMSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIixjLCExKTtsZXQgbz1lfHwobnVsbCE9PWU/YTpudWxsKTtvJiZ0KG8sbikscj0hMSxpPW51bGx9fX0oYykpO2NvbnN0IHA9e2Nsb3NlOnYsY3JlYXRlOmZ1bmN0aW9uKCl7aWYobClyZXR1cm4hMTtsZXQgZT11LmFsZXJ0P1wiYWxlcnRkaWFsb2dcIjpcImRpYWxvZ1wiO2lmKGMuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIixcIi0xXCIpLGMuc2V0QXR0cmlidXRlKFwicm9sZVwiLGUpLGMuc2V0QXR0cmlidXRlKFwiYXJpYS1tb2RhbFwiLFwidHJ1ZVwiKSx1LmxhYmVsKXtsZXQgZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh1LmxhYmVsKT9cImFyaWEtbGFiZWxsZWRieVwiOlwiYXJpYS1sYWJlbFwiO2Muc2V0QXR0cmlidXRlKGUsdS5sYWJlbCl9dS5kZXNjcmlwdGlvbiYmZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodS5kZXNjcmlwdGlvbikmJmMuc2V0QXR0cmlidXRlKFwiYXJpYS1kZXNjcmliZWRieVwiLHUuZGVzY3JpcHRpb24pLGw9ITAsYihcImNyZWF0ZVwiKX0sZGVzdHJveTpmdW5jdGlvbigpe2lmKCFsKXJldHVybiExO3YoKSxsPSExLFtcInJvbGVcIixcInRhYmluZGV4XCIsXCJhcmlhLW1vZGFsXCIsXCJhcmlhLWxhYmVsXCIsXCJhcmlhLWxhYmVsbGVkYnlcIixcImFyaWEtZGVzY3JpYmVkYnlcIl0uZm9yRWFjaChlPT5jLnJlbW92ZUF0dHJpYnV0ZShlKSksYihcImRlc3Ryb3lcIil9LGVsZW1lbnQ6YyxpZDplLGluaXRpYXRlZDpsLGdldCBpc09wZW4oKXtyZXR1cm4gYX0sb2ZmOmZ1bmN0aW9uKGUsdCl7bGV0IG49XCJkaWFsb2c6XCIrZTtjLnJlbW92ZUV2ZW50TGlzdGVuZXIobix0KX0sb246ZnVuY3Rpb24oZSx0KXtsZXQgbj1cImRpYWxvZzpcIitlO2MuYWRkRXZlbnRMaXN0ZW5lcihuLHQpfSxvcGVuOm0sdG9nZ2xlOmZ1bmN0aW9uKGU9IWEpe2U/bSgpOnYoKX19O3JldHVybiBzW2VdPXB9ZXhwb3J0e20gYXMgZGlhbG9nLHUgYXMgZG9tYXBpLGYgYXMgZ2V0SW5zdGFuY2VCeUlkLHMgYXMgaW5zdGFuY2VzfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRpYWxvZy5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../../../../node_modules/@rynpsc/dialog/dist/module/dialog.js\n");

/***/ }),

/***/ "./src/js/payments/opayo.js":
/*!**********************************!*\
  !*** ./src/js/payments/opayo.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"FormieOpayo\": () => (/* binding */ FormieOpayo)\n/* harmony export */ });\n/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/utils */ \"./src/js/utils/utils.js\");\n/* harmony import */ var _payment_provider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./payment-provider */ \"./src/js/payments/payment-provider.js\");\n/* harmony import */ var _rynpsc_dialog__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @rynpsc/dialog */ \"../../../../node_modules/@rynpsc/dialog/dist/module/dialog.js\");\n/* harmony import */ var payment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! payment */ \"../../../../node_modules/payment/lib/index.js\");\n/* harmony import */ var payment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(payment__WEBPACK_IMPORTED_MODULE_3__);\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n\n\n\n\nvar FormieOpayo = /*#__PURE__*/function (_FormiePaymentProvide) {\n  _inherits(FormieOpayo, _FormiePaymentProvide);\n\n  var _super = _createSuper(FormieOpayo);\n\n  function FormieOpayo() {\n    var _this;\n\n    var settings = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, FormieOpayo);\n\n    _this = _super.call(this, settings);\n    _this.$form = settings.$form;\n    _this.form = _this.$form.form;\n    _this.$field = settings.$field;\n    _this.useSandbox = settings.useSandbox;\n    _this.integrationHandle = settings.handle;\n    _this.currency = settings.currency;\n    _this.amountType = settings.amountType;\n    _this.amountFixed = settings.amountFixed;\n    _this.amountVariable = settings.amountVariable;\n    _this.opayoScriptId = 'FORMIE_OPAYO_SCRIPT'; // We can start listening for the field to become visible to initialize it\n\n    _this.initialized = true;\n    return _this;\n  }\n\n  _createClass(FormieOpayo, [{\n    key: \"onShow\",\n    value: function onShow() {\n      // Initialize the field only when it's visible\n      this.initField();\n    }\n  }, {\n    key: \"onHide\",\n    value: function onHide() {\n      // Field is hidden, so reset everything\n      this.onAfterSubmit(); // Remove unique event listeners\n\n      this.form.removeEventListener((0,_utils_utils__WEBPACK_IMPORTED_MODULE_0__.eventKey)('onFormiePaymentValidate', 'opayo'));\n      this.form.removeEventListener((0,_utils_utils__WEBPACK_IMPORTED_MODULE_0__.eventKey)('onAfterFormieSubmit', 'opayo'));\n      this.form.removeEventListener((0,_utils_utils__WEBPACK_IMPORTED_MODULE_0__.eventKey)('FormiePaymentOpayo3DS', 'opayo'));\n    }\n  }, {\n    key: \"initField\",\n    value: function initField() {\n      // Fetch and attach the script only once - this is in case there are multiple forms on the page.\n      // They all go to a single callback which resolves its loaded state\n      if (!document.getElementById(this.opayoScriptId)) {\n        var $script = document.createElement('script');\n        $script.id = this.opayoScriptId;\n\n        if (this.useSandbox) {\n          $script.src = 'https://pi-test.sagepay.com/api/v1/js/sagepay.js';\n        } else {\n          $script.src = 'https://pi-live.sagepay.com/api/v1/js/sagepay.js';\n        }\n\n        $script.async = true;\n        $script.defer = true;\n        document.body.appendChild($script);\n      } // Attach custom event listeners on the form\n\n\n      this.form.addEventListener(this.$form, (0,_utils_utils__WEBPACK_IMPORTED_MODULE_0__.eventKey)('onFormiePaymentValidate', 'opayo'), this.onValidate.bind(this));\n      this.form.addEventListener(this.$form, (0,_utils_utils__WEBPACK_IMPORTED_MODULE_0__.eventKey)('onAfterFormieSubmit', 'opayo'), this.onAfterSubmit.bind(this));\n      this.form.addEventListener(this.$form, (0,_utils_utils__WEBPACK_IMPORTED_MODULE_0__.eventKey)('FormiePaymentOpayo3DS', 'opayo'), this.onValidate3DS.bind(this)); // Listen to events sent from the iframe to complete 3DS challenge\n\n      window.addEventListener('message', this.onMessage.bind(this), false); // Add input masking and validation for some fields\n\n      payment__WEBPACK_IMPORTED_MODULE_3___default().formatCardNumber(this.$field.querySelector('[data-opayo-card=\"card-number\"]'));\n      payment__WEBPACK_IMPORTED_MODULE_3___default().formatCardExpiry(this.$field.querySelector('[data-opayo-card=\"expiry-date\"]'));\n      payment__WEBPACK_IMPORTED_MODULE_3___default().formatCardCVC(this.$field.querySelector('[data-opayo-card=\"security-code\"]'));\n    }\n  }, {\n    key: \"onValidate\",\n    value: function onValidate(e) {\n      var _this2 = this;\n\n      // Don't validate if we're not submitting (going back, saving)\n      // Check if the form has an invalid flag set, don't bother going further\n      if (this.form.submitAction !== 'submit' || e.detail.invalid) {\n        return;\n      }\n\n      e.preventDefault(); // Save for later to trigger real submit\n\n      this.submitHandler = e.detail.submitHandler;\n      this.removeError();\n\n      try {\n        // Fetch/generate the merchant ID first via an Ajax request\n        var action = this.$form.getAttribute('action');\n        var xhr = new XMLHttpRequest();\n        xhr.open('POST', action ? action : window.location.href, true);\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n        xhr.setRequestHeader('Accept', 'application/json');\n        xhr.setRequestHeader('Cache-Control', 'no-cache');\n\n        xhr.ontimeout = function () {\n          self.addError(t('The request timed out.'));\n        };\n\n        xhr.onerror = function (e) {\n          self.addError(t('The request encountered a network error. Please try again.'));\n        };\n\n        xhr.onload = function () {\n          if (xhr.status >= 200 && xhr.status < 300) {\n            try {\n              var response = JSON.parse(xhr.responseText); // Get the data from the client\n\n              var cardDetails = {\n                cardholderName: _this2.$field.querySelector('[data-opayo-card=\"cardholder-name\"]').value,\n                cardNumber: _this2.$field.querySelector('[data-opayo-card=\"card-number\"]').value,\n                expiryDate: _this2.$field.querySelector('[data-opayo-card=\"expiry-date\"]').value,\n                securityCode: _this2.$field.querySelector('[data-opayo-card=\"security-code\"]').value\n              }; // Remove formatting\n\n              cardDetails.cardNumber = cardDetails.cardNumber.replace(/[\\s/]/g, '');\n              cardDetails.expiryDate = cardDetails.expiryDate.replace(/[\\s/]/g, ''); // With the `merchantSessionKey`, now tokenize the credit card form and trigger submit\n\n              sagepayOwnForm({\n                merchantSessionKey: response.merchantSessionKey\n              }).tokeniseCardDetails({\n                cardDetails: cardDetails,\n                onTokenised: function onTokenised(result) {\n                  if (result.success) {\n                    // Append an input so it's not namespaced with Twig\n                    _this2.updateInputs('opayoTokenId', result.cardIdentifier);\n\n                    _this2.updateInputs('opayoSessionKey', response.merchantSessionKey);\n\n                    _this2.submitHandler.submitForm();\n                  } else {\n                    console.error(result);\n\n                    _this2.addError(result.errors[0].message);\n                  }\n                }\n              });\n            } catch (e) {\n              _this2.addError(t('Unable to parse response `{e}`.', {\n                e: e\n              }));\n            }\n          } else {\n            _this2.addError(\"\".concat(xhr.status, \": \").concat(xhr.statusText));\n          }\n        };\n\n        var data = new FormData();\n        data.append('action', 'formie/payment-webhooks/process-callback');\n        data.append('merchantSessionKey', true);\n        data.append('handle', this.integrationHandle);\n        xhr.send(data);\n      } catch (ex) {\n        console.error(ex);\n        this.addError(ex);\n      }\n    }\n  }, {\n    key: \"addLoading\",\n    value: function addLoading() {\n      if (this.form.formTheme) {\n        this.form.formTheme.addLoading();\n      }\n    }\n  }, {\n    key: \"removeLoading\",\n    value: function removeLoading() {\n      if (this.form.formTheme) {\n        this.form.formTheme.removeLoading();\n      }\n    }\n  }, {\n    key: \"onMessage\",\n    value: function onMessage(e) {\n      // Check this is the correct message\n      if (e.data.message !== 'FormiePaymentOpayo3DSResponse') {\n        return;\n      }\n\n      if (this.dialog) {\n        this.dialog.close();\n      }\n\n      this.removeError();\n\n      if (e.data.value.error) {\n        this.removeLoading();\n        return this.addError(e.data.value.error.message);\n      } // Add a flag for server-side to check and finalise\n\n\n      this.updateInputs('opayo3DSComplete', e.data.value.transactionId);\n      this.submitHandler.submitForm();\n    }\n  }, {\n    key: \"onValidate3DS\",\n    value: function onValidate3DS(e) {\n      try {\n        var data = e.detail.data; // Keep the spinner going for 3DS\n\n        this.addLoading();\n        var dialogId = \"fui-opayo-dialog-\".concat((Math.random() + 1).toString(36).substring(7));\n        var $dialog = document.createElement('div');\n        $dialog.setAttribute('class', 'fui-modal');\n        $dialog.setAttribute('id', dialogId);\n        var $dialogBackdrop = document.createElement('div');\n        $dialogBackdrop.setAttribute('class', 'fui-modal-backdrop');\n        $dialogBackdrop.setAttribute('data-dialog-close', 'dialog');\n        $dialog.appendChild($dialogBackdrop);\n        var $dialogContent = document.createElement('div');\n        $dialogContent.setAttribute('class', 'fui-modal-content');\n        $dialog.appendChild($dialogContent);\n        var $dialogLoading = document.createElement('div');\n        $dialogLoading.setAttribute('class', 'fui-loading fui-loading-large');\n        $dialogLoading.setAttribute('style', '--fui-loading-width: 3rem; --fui-loading-height: 3rem; --fui-loading-border-width: 4px; top: 50%; margin-top: -1.5rem;');\n        $dialogContent.appendChild($dialogLoading);\n        var $iframe = document.createElement('iframe');\n        $iframe.setAttribute('width', '100%');\n        $iframe.setAttribute('height', '100%');\n        $iframe.setAttribute('style', 'width: 100%; height: 100%; position: relative; z-index: 1;');\n        var html = \"<form action=\\\"\".concat(data.acsUrl, \"\\\" method=\\\"post\\\">\\n                <input type=\\\"hidden\\\" name=\\\"creq\\\" value=\\\"\").concat(data.creq, \"\\\" />\\n                <input type=\\\"hidden\\\" name=\\\"threeDSSessionData\\\" value=\\\"\").concat(data.threeDSSessionData, \"\\\" />\\n                <input type=\\\"hidden\\\" name=\\\"MD\\\" value=\\\"\").concat(this.merchantSessionKey, \"\\\" />\\n                <input type=\\\"hidden\\\" name=\\\"TermUrl\\\" value=\\\"\").concat(data.redirectUrl, \"\\\" />\\n                <input type=\\\"hidden\\\" name=\\\"ThreeDSNotificationURL\\\" value=\\\"\").concat(data.redirectUrl, \"\\\" />\\n            </form>\\n            <script>document.forms[0].submit();</script>\");\n        $dialogContent.appendChild($iframe);\n        document.body.appendChild($dialog);\n        $iframe.contentWindow.document.open();\n        $iframe.contentWindow.document.write(html);\n        $iframe.contentWindow.document.close();\n        this.dialog = (0,_rynpsc_dialog__WEBPACK_IMPORTED_MODULE_2__.dialog)(dialogId);\n\n        if (this.dialog) {\n          this.dialog.create();\n          this.dialog.open();\n        }\n      } catch (ex) {\n        console.error(ex);\n        self.addError(ex);\n      }\n    }\n  }, {\n    key: \"onAfterSubmit\",\n    value: function onAfterSubmit(e) {\n      // Reset all hidden inputs\n      this.updateInputs('opayoTokenId', '');\n      this.updateInputs('opayoSessionKey', '');\n      this.updateInputs('opayo3DSComplete', '');\n    }\n  }]);\n\n  return FormieOpayo;\n}(_payment_provider__WEBPACK_IMPORTED_MODULE_1__.FormiePaymentProvider);\nwindow.FormieOpayo = FormieOpayo;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQ0MsS0FBUixDQUFjUSxFQUFkO1FBRUFuQyxJQUFJLENBQUNDLFFBQUwsQ0FBY2tDLEVBQWQ7TUFDSDtJQUNKO0VBOVBMO0lBQUE7SUFBQSxPQWdRSSx1QkFBY25ELENBQWQsRUFBaUI7TUFDYjtNQUNBLEtBQUt1QyxZQUFMLENBQWtCLGNBQWxCLEVBQWtDLEVBQWxDO01BQ0EsS0FBS0EsWUFBTCxDQUFrQixpQkFBbEIsRUFBcUMsRUFBckM7TUFDQSxLQUFLQSxZQUFMLENBQWtCLGtCQUFsQixFQUFzQyxFQUF0QztJQUNIO0VBclFMOztFQUFBO0FBQUEsRUFBaUMvRSxvRUFBakM7QUF3UUFrQyxNQUFNLENBQUMvQixXQUFQLEdBQXFCQSxXQUFyQiIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9qcy9wYXltZW50cy9vcGF5by5qcz9iZGI2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV2ZW50S2V5IH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgRm9ybWllUGF5bWVudFByb3ZpZGVyIH0gZnJvbSAnLi9wYXltZW50LXByb3ZpZGVyJztcbmltcG9ydCB7IGRpYWxvZyB9IGZyb20gJ0ByeW5wc2MvZGlhbG9nJztcbmltcG9ydCBQYXltZW50IGZyb20gJ3BheW1lbnQnO1xuXG5leHBvcnQgY2xhc3MgRm9ybWllT3BheW8gZXh0ZW5kcyBGb3JtaWVQYXltZW50UHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzID0ge30pIHtcbiAgICAgICAgc3VwZXIoc2V0dGluZ3MpO1xuXG4gICAgICAgIHRoaXMuJGZvcm0gPSBzZXR0aW5ncy4kZm9ybTtcbiAgICAgICAgdGhpcy5mb3JtID0gdGhpcy4kZm9ybS5mb3JtO1xuICAgICAgICB0aGlzLiRmaWVsZCA9IHNldHRpbmdzLiRmaWVsZDtcblxuICAgICAgICB0aGlzLnVzZVNhbmRib3ggPSBzZXR0aW5ncy51c2VTYW5kYm94O1xuICAgICAgICB0aGlzLmludGVncmF0aW9uSGFuZGxlID0gc2V0dGluZ3MuaGFuZGxlO1xuICAgICAgICB0aGlzLmN1cnJlbmN5ID0gc2V0dGluZ3MuY3VycmVuY3k7XG4gICAgICAgIHRoaXMuYW1vdW50VHlwZSA9IHNldHRpbmdzLmFtb3VudFR5cGU7XG4gICAgICAgIHRoaXMuYW1vdW50Rml4ZWQgPSBzZXR0aW5ncy5hbW91bnRGaXhlZDtcbiAgICAgICAgdGhpcy5hbW91bnRWYXJpYWJsZSA9IHNldHRpbmdzLmFtb3VudFZhcmlhYmxlO1xuICAgICAgICB0aGlzLm9wYXlvU2NyaXB0SWQgPSAnRk9STUlFX09QQVlPX1NDUklQVCc7XG5cbiAgICAgICAgLy8gV2UgY2FuIHN0YXJ0IGxpc3RlbmluZyBmb3IgdGhlIGZpZWxkIHRvIGJlY29tZSB2aXNpYmxlIHRvIGluaXRpYWxpemUgaXRcbiAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgfVxuXG4gICAgb25TaG93KCkge1xuICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBmaWVsZCBvbmx5IHdoZW4gaXQncyB2aXNpYmxlXG4gICAgICAgIHRoaXMuaW5pdEZpZWxkKCk7XG4gICAgfVxuXG4gICAgb25IaWRlKCkge1xuICAgICAgICAvLyBGaWVsZCBpcyBoaWRkZW4sIHNvIHJlc2V0IGV2ZXJ5dGhpbmdcbiAgICAgICAgdGhpcy5vbkFmdGVyU3VibWl0KCk7XG5cbiAgICAgICAgLy8gUmVtb3ZlIHVuaXF1ZSBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgdGhpcy5mb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRLZXkoJ29uRm9ybWllUGF5bWVudFZhbGlkYXRlJywgJ29wYXlvJykpO1xuICAgICAgICB0aGlzLmZvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudEtleSgnb25BZnRlckZvcm1pZVN1Ym1pdCcsICdvcGF5bycpKTtcbiAgICAgICAgdGhpcy5mb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRLZXkoJ0Zvcm1pZVBheW1lbnRPcGF5bzNEUycsICdvcGF5bycpKTtcbiAgICB9XG5cbiAgICBpbml0RmllbGQoKSB7XG4gICAgICAgIC8vIEZldGNoIGFuZCBhdHRhY2ggdGhlIHNjcmlwdCBvbmx5IG9uY2UgLSB0aGlzIGlzIGluIGNhc2UgdGhlcmUgYXJlIG11bHRpcGxlIGZvcm1zIG9uIHRoZSBwYWdlLlxuICAgICAgICAvLyBUaGV5IGFsbCBnbyB0byBhIHNpbmdsZSBjYWxsYmFjayB3aGljaCByZXNvbHZlcyBpdHMgbG9hZGVkIHN0YXRlXG4gICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5vcGF5b1NjcmlwdElkKSkge1xuICAgICAgICAgICAgY29uc3QgJHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICAgICAgJHNjcmlwdC5pZCA9IHRoaXMub3BheW9TY3JpcHRJZDtcblxuICAgICAgICAgICAgaWYgKHRoaXMudXNlU2FuZGJveCkge1xuICAgICAgICAgICAgICAgICRzY3JpcHQuc3JjID0gJ2h0dHBzOi8vcGktdGVzdC5zYWdlcGF5LmNvbS9hcGkvdjEvanMvc2FnZXBheS5qcyc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY3JpcHQuc3JjID0gJ2h0dHBzOi8vcGktbGl2ZS5zYWdlcGF5LmNvbS9hcGkvdjEvanMvc2FnZXBheS5qcyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY3JpcHQuYXN5bmMgPSB0cnVlO1xuICAgICAgICAgICAgJHNjcmlwdC5kZWZlciA9IHRydWU7XG5cbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoJHNjcmlwdCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBdHRhY2ggY3VzdG9tIGV2ZW50IGxpc3RlbmVycyBvbiB0aGUgZm9ybVxuICAgICAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcih0aGlzLiRmb3JtLCBldmVudEtleSgnb25Gb3JtaWVQYXltZW50VmFsaWRhdGUnLCAnb3BheW8nKSwgdGhpcy5vblZhbGlkYXRlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcih0aGlzLiRmb3JtLCBldmVudEtleSgnb25BZnRlckZvcm1pZVN1Ym1pdCcsICdvcGF5bycpLCB0aGlzLm9uQWZ0ZXJTdWJtaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKHRoaXMuJGZvcm0sIGV2ZW50S2V5KCdGb3JtaWVQYXltZW50T3BheW8zRFMnLCAnb3BheW8nKSwgdGhpcy5vblZhbGlkYXRlM0RTLmJpbmQodGhpcykpO1xuXG4gICAgICAgIC8vIExpc3RlbiB0byBldmVudHMgc2VudCBmcm9tIHRoZSBpZnJhbWUgdG8gY29tcGxldGUgM0RTIGNoYWxsZW5nZVxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMub25NZXNzYWdlLmJpbmQodGhpcyksIGZhbHNlKTtcblxuICAgICAgICAvLyBBZGQgaW5wdXQgbWFza2luZyBhbmQgdmFsaWRhdGlvbiBmb3Igc29tZSBmaWVsZHNcbiAgICAgICAgUGF5bWVudC5mb3JtYXRDYXJkTnVtYmVyKHRoaXMuJGZpZWxkLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW9wYXlvLWNhcmQ9XCJjYXJkLW51bWJlclwiXScpKTtcbiAgICAgICAgUGF5bWVudC5mb3JtYXRDYXJkRXhwaXJ5KHRoaXMuJGZpZWxkLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW9wYXlvLWNhcmQ9XCJleHBpcnktZGF0ZVwiXScpKTtcbiAgICAgICAgUGF5bWVudC5mb3JtYXRDYXJkQ1ZDKHRoaXMuJGZpZWxkLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW9wYXlvLWNhcmQ9XCJzZWN1cml0eS1jb2RlXCJdJykpO1xuICAgIH1cblxuICAgIG9uVmFsaWRhdGUoZSkge1xuICAgICAgICAvLyBEb24ndCB2YWxpZGF0ZSBpZiB3ZSdyZSBub3Qgc3VibWl0dGluZyAoZ29pbmcgYmFjaywgc2F2aW5nKVxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgZm9ybSBoYXMgYW4gaW52YWxpZCBmbGFnIHNldCwgZG9uJ3QgYm90aGVyIGdvaW5nIGZ1cnRoZXJcbiAgICAgICAgaWYgKHRoaXMuZm9ybS5zdWJtaXRBY3Rpb24gIT09ICdzdWJtaXQnIHx8IGUuZGV0YWlsLmludmFsaWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAvLyBTYXZlIGZvciBsYXRlciB0byB0cmlnZ2VyIHJlYWwgc3VibWl0XG4gICAgICAgIHRoaXMuc3VibWl0SGFuZGxlciA9IGUuZGV0YWlsLnN1Ym1pdEhhbmRsZXI7XG5cbiAgICAgICAgdGhpcy5yZW1vdmVFcnJvcigpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBGZXRjaC9nZW5lcmF0ZSB0aGUgbWVyY2hhbnQgSUQgZmlyc3QgdmlhIGFuIEFqYXggcmVxdWVzdFxuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy4kZm9ybS5nZXRBdHRyaWJ1dGUoJ2FjdGlvbicpO1xuXG4gICAgICAgICAgICBjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgIHhoci5vcGVuKCdQT1NUJywgYWN0aW9uID8gYWN0aW9uIDogd2luZG93LmxvY2F0aW9uLmhyZWYsIHRydWUpO1xuICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ1gtUmVxdWVzdGVkLVdpdGgnLCAnWE1MSHR0cFJlcXVlc3QnKTtcbiAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NhY2hlLUNvbnRyb2wnLCAnbm8tY2FjaGUnKTtcblxuICAgICAgICAgICAgeGhyLm9udGltZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLmFkZEVycm9yKHQoJ1RoZSByZXF1ZXN0IHRpbWVkIG91dC4nKSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB4aHIub25lcnJvciA9IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZi5hZGRFcnJvcih0KCdUaGUgcmVxdWVzdCBlbmNvdW50ZXJlZCBhIG5ldHdvcmsgZXJyb3IuIFBsZWFzZSB0cnkgYWdhaW4uJykpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgeGhyLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8IDMwMCkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIGRhdGEgZnJvbSB0aGUgY2xpZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXJkRGV0YWlscyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkaG9sZGVyTmFtZTogdGhpcy4kZmllbGQucXVlcnlTZWxlY3RvcignW2RhdGEtb3BheW8tY2FyZD1cImNhcmRob2xkZXItbmFtZVwiXScpLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmROdW1iZXI6IHRoaXMuJGZpZWxkLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW9wYXlvLWNhcmQ9XCJjYXJkLW51bWJlclwiXScpLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyeURhdGU6IHRoaXMuJGZpZWxkLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW9wYXlvLWNhcmQ9XCJleHBpcnktZGF0ZVwiXScpLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY3VyaXR5Q29kZTogdGhpcy4kZmllbGQucXVlcnlTZWxlY3RvcignW2RhdGEtb3BheW8tY2FyZD1cInNlY3VyaXR5LWNvZGVcIl0nKS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBmb3JtYXR0aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkRGV0YWlscy5jYXJkTnVtYmVyID0gY2FyZERldGFpbHMuY2FyZE51bWJlci5yZXBsYWNlKC9bXFxzL10vZywgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZERldGFpbHMuZXhwaXJ5RGF0ZSA9IGNhcmREZXRhaWxzLmV4cGlyeURhdGUucmVwbGFjZSgvW1xccy9dL2csICcnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2l0aCB0aGUgYG1lcmNoYW50U2Vzc2lvbktleWAsIG5vdyB0b2tlbml6ZSB0aGUgY3JlZGl0IGNhcmQgZm9ybSBhbmQgdHJpZ2dlciBzdWJtaXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhZ2VwYXlPd25Gb3JtKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudFNlc3Npb25LZXk6IHJlc3BvbnNlLm1lcmNoYW50U2Vzc2lvbktleSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRva2VuaXNlQ2FyZERldGFpbHMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmREZXRhaWxzLFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Ub2tlbmlzZWQ6IChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmQgYW4gaW5wdXQgc28gaXQncyBub3QgbmFtZXNwYWNlZCB3aXRoIFR3aWdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlSW5wdXRzKCdvcGF5b1Rva2VuSWQnLCByZXN1bHQuY2FyZElkZW50aWZpZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVJbnB1dHMoJ29wYXlvU2Vzc2lvbktleScsIHJlc3BvbnNlLm1lcmNoYW50U2Vzc2lvbktleSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0SGFuZGxlci5zdWJtaXRGb3JtKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlc3VsdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRXJyb3IocmVzdWx0LmVycm9yc1swXS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRFcnJvcih0KCdVbmFibGUgdG8gcGFyc2UgcmVzcG9uc2UgYHtlfWAuJywgeyBlIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRXJyb3IoYCR7eGhyLnN0YXR1c306ICR7eGhyLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJ2FjdGlvbicsICdmb3JtaWUvcGF5bWVudC13ZWJob29rcy9wcm9jZXNzLWNhbGxiYWNrJyk7XG4gICAgICAgICAgICBkYXRhLmFwcGVuZCgnbWVyY2hhbnRTZXNzaW9uS2V5JywgdHJ1ZSk7XG4gICAgICAgICAgICBkYXRhLmFwcGVuZCgnaGFuZGxlJywgdGhpcy5pbnRlZ3JhdGlvbkhhbmRsZSk7XG5cbiAgICAgICAgICAgIHhoci5zZW5kKGRhdGEpO1xuICAgICAgICB9IGNhdGNoIChleCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihleCk7XG5cbiAgICAgICAgICAgIHRoaXMuYWRkRXJyb3IoZXgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWRkTG9hZGluZygpIHtcbiAgICAgICAgaWYgKHRoaXMuZm9ybS5mb3JtVGhlbWUpIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybS5mb3JtVGhlbWUuYWRkTG9hZGluZygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVtb3ZlTG9hZGluZygpIHtcbiAgICAgICAgaWYgKHRoaXMuZm9ybS5mb3JtVGhlbWUpIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybS5mb3JtVGhlbWUucmVtb3ZlTG9hZGluZygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25NZXNzYWdlKGUpIHtcbiAgICAgICAgLy8gQ2hlY2sgdGhpcyBpcyB0aGUgY29ycmVjdCBtZXNzYWdlXG4gICAgICAgIGlmIChlLmRhdGEubWVzc2FnZSAhPT0gJ0Zvcm1pZVBheW1lbnRPcGF5bzNEU1Jlc3BvbnNlJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZGlhbG9nKSB7XG4gICAgICAgICAgICB0aGlzLmRpYWxvZy5jbG9zZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZW1vdmVFcnJvcigpO1xuXG4gICAgICAgIGlmIChlLmRhdGEudmFsdWUuZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlTG9hZGluZygpO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRFcnJvcihlLmRhdGEudmFsdWUuZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgYSBmbGFnIGZvciBzZXJ2ZXItc2lkZSB0byBjaGVjayBhbmQgZmluYWxpc2VcbiAgICAgICAgdGhpcy51cGRhdGVJbnB1dHMoJ29wYXlvM0RTQ29tcGxldGUnLCBlLmRhdGEudmFsdWUudHJhbnNhY3Rpb25JZCk7XG5cbiAgICAgICAgdGhpcy5zdWJtaXRIYW5kbGVyLnN1Ym1pdEZvcm0oKTtcbiAgICB9XG5cbiAgICBvblZhbGlkYXRlM0RTKGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gZS5kZXRhaWw7XG5cbiAgICAgICAgICAgIC8vIEtlZXAgdGhlIHNwaW5uZXIgZ29pbmcgZm9yIDNEU1xuICAgICAgICAgICAgdGhpcy5hZGRMb2FkaW5nKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRpYWxvZ0lkID0gYGZ1aS1vcGF5by1kaWFsb2ctJHsoTWF0aC5yYW5kb20oKSArIDEpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoNyl9YDtcblxuICAgICAgICAgICAgY29uc3QgJGRpYWxvZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgJGRpYWxvZy5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2Z1aS1tb2RhbCcpO1xuICAgICAgICAgICAgJGRpYWxvZy5zZXRBdHRyaWJ1dGUoJ2lkJywgZGlhbG9nSWQpO1xuXG4gICAgICAgICAgICBjb25zdCAkZGlhbG9nQmFja2Ryb3AgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICRkaWFsb2dCYWNrZHJvcC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2Z1aS1tb2RhbC1iYWNrZHJvcCcpO1xuICAgICAgICAgICAgJGRpYWxvZ0JhY2tkcm9wLnNldEF0dHJpYnV0ZSgnZGF0YS1kaWFsb2ctY2xvc2UnLCAnZGlhbG9nJyk7XG4gICAgICAgICAgICAkZGlhbG9nLmFwcGVuZENoaWxkKCRkaWFsb2dCYWNrZHJvcCk7XG5cbiAgICAgICAgICAgIGNvbnN0ICRkaWFsb2dDb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAkZGlhbG9nQ29udGVudC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2Z1aS1tb2RhbC1jb250ZW50Jyk7XG4gICAgICAgICAgICAkZGlhbG9nLmFwcGVuZENoaWxkKCRkaWFsb2dDb250ZW50KTtcblxuICAgICAgICAgICAgY29uc3QgJGRpYWxvZ0xvYWRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICRkaWFsb2dMb2FkaW5nLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnZnVpLWxvYWRpbmcgZnVpLWxvYWRpbmctbGFyZ2UnKTtcbiAgICAgICAgICAgICRkaWFsb2dMb2FkaW5nLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnLS1mdWktbG9hZGluZy13aWR0aDogM3JlbTsgLS1mdWktbG9hZGluZy1oZWlnaHQ6IDNyZW07IC0tZnVpLWxvYWRpbmctYm9yZGVyLXdpZHRoOiA0cHg7IHRvcDogNTAlOyBtYXJnaW4tdG9wOiAtMS41cmVtOycpO1xuICAgICAgICAgICAgJGRpYWxvZ0NvbnRlbnQuYXBwZW5kQ2hpbGQoJGRpYWxvZ0xvYWRpbmcpO1xuXG4gICAgICAgICAgICBjb25zdCAkaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XG4gICAgICAgICAgICAkaWZyYW1lLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMTAwJScpO1xuICAgICAgICAgICAgJGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcxMDAlJyk7XG4gICAgICAgICAgICAkaWZyYW1lLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgcG9zaXRpb246IHJlbGF0aXZlOyB6LWluZGV4OiAxOycpO1xuXG4gICAgICAgICAgICBjb25zdCBodG1sID0gYDxmb3JtIGFjdGlvbj1cIiR7ZGF0YS5hY3NVcmx9XCIgbWV0aG9kPVwicG9zdFwiPlxuICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cImNyZXFcIiB2YWx1ZT1cIiR7ZGF0YS5jcmVxfVwiIC8+XG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwidGhyZWVEU1Nlc3Npb25EYXRhXCIgdmFsdWU9XCIke2RhdGEudGhyZWVEU1Nlc3Npb25EYXRhfVwiIC8+XG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiTURcIiB2YWx1ZT1cIiR7dGhpcy5tZXJjaGFudFNlc3Npb25LZXl9XCIgLz5cbiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJUZXJtVXJsXCIgdmFsdWU9XCIke2RhdGEucmVkaXJlY3RVcmx9XCIgLz5cbiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJUaHJlZURTTm90aWZpY2F0aW9uVVJMXCIgdmFsdWU9XCIke2RhdGEucmVkaXJlY3RVcmx9XCIgLz5cbiAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgICAgIDxzY3JpcHQ+ZG9jdW1lbnQuZm9ybXNbMF0uc3VibWl0KCk7PC9zY3JpcHQ+YDtcblxuICAgICAgICAgICAgJGRpYWxvZ0NvbnRlbnQuYXBwZW5kQ2hpbGQoJGlmcmFtZSk7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCRkaWFsb2cpO1xuXG4gICAgICAgICAgICAkaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQub3BlbigpO1xuICAgICAgICAgICAgJGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LndyaXRlKGh0bWwpO1xuICAgICAgICAgICAgJGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LmNsb3NlKCk7XG5cbiAgICAgICAgICAgIHRoaXMuZGlhbG9nID0gZGlhbG9nKGRpYWxvZ0lkKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuZGlhbG9nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaWFsb2cuY3JlYXRlKCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZy5vcGVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGV4KTtcblxuICAgICAgICAgICAgc2VsZi5hZGRFcnJvcihleCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkFmdGVyU3VibWl0KGUpIHtcbiAgICAgICAgLy8gUmVzZXQgYWxsIGhpZGRlbiBpbnB1dHNcbiAgICAgICAgdGhpcy51cGRhdGVJbnB1dHMoJ29wYXlvVG9rZW5JZCcsICcnKTtcbiAgICAgICAgdGhpcy51cGRhdGVJbnB1dHMoJ29wYXlvU2Vzc2lvbktleScsICcnKTtcbiAgICAgICAgdGhpcy51cGRhdGVJbnB1dHMoJ29wYXlvM0RTQ29tcGxldGUnLCAnJyk7XG4gICAgfVxufVxuXG53aW5kb3cuRm9ybWllT3BheW8gPSBGb3JtaWVPcGF5bztcbiJdLCJuYW1lcyI6WyJldmVudEtleSIsIkZvcm1pZVBheW1lbnRQcm92aWRlciIsImRpYWxvZyIsIlBheW1lbnQiLCJGb3JtaWVPcGF5byIsInNldHRpbmdzIiwiJGZvcm0iLCJmb3JtIiwiJGZpZWxkIiwidXNlU2FuZGJveCIsImludGVncmF0aW9uSGFuZGxlIiwiaGFuZGxlIiwiY3VycmVuY3kiLCJhbW91bnRUeXBlIiwiYW1vdW50Rml4ZWQiLCJhbW91bnRWYXJpYWJsZSIsIm9wYXlvU2NyaXB0SWQiLCJpbml0aWFsaXplZCIsImluaXRGaWVsZCIsIm9uQWZ0ZXJTdWJtaXQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIiRzY3JpcHQiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJzcmMiLCJhc3luYyIsImRlZmVyIiwiYm9keSIsImFwcGVuZENoaWxkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uVmFsaWRhdGUiLCJiaW5kIiwib25WYWxpZGF0ZTNEUyIsIndpbmRvdyIsIm9uTWVzc2FnZSIsImZvcm1hdENhcmROdW1iZXIiLCJxdWVyeVNlbGVjdG9yIiwiZm9ybWF0Q2FyZEV4cGlyeSIsImZvcm1hdENhcmRDVkMiLCJlIiwic3VibWl0QWN0aW9uIiwiZGV0YWlsIiwiaW52YWxpZCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0SGFuZGxlciIsInJlbW92ZUVycm9yIiwiYWN0aW9uIiwiZ2V0QXR0cmlidXRlIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwibG9jYXRpb24iLCJocmVmIiwic2V0UmVxdWVzdEhlYWRlciIsIm9udGltZW91dCIsInNlbGYiLCJhZGRFcnJvciIsInQiLCJvbmVycm9yIiwib25sb2FkIiwic3RhdHVzIiwicmVzcG9uc2UiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJjYXJkRGV0YWlscyIsImNhcmRob2xkZXJOYW1lIiwidmFsdWUiLCJjYXJkTnVtYmVyIiwiZXhwaXJ5RGF0ZSIsInNlY3VyaXR5Q29kZSIsInJlcGxhY2UiLCJzYWdlcGF5T3duRm9ybSIsIm1lcmNoYW50U2Vzc2lvbktleSIsInRva2VuaXNlQ2FyZERldGFpbHMiLCJvblRva2VuaXNlZCIsInJlc3VsdCIsInN1Y2Nlc3MiLCJ1cGRhdGVJbnB1dHMiLCJjYXJkSWRlbnRpZmllciIsInN1Ym1pdEZvcm0iLCJjb25zb2xlIiwiZXJyb3IiLCJlcnJvcnMiLCJtZXNzYWdlIiwic3RhdHVzVGV4dCIsImRhdGEiLCJGb3JtRGF0YSIsImFwcGVuZCIsInNlbmQiLCJleCIsImZvcm1UaGVtZSIsImFkZExvYWRpbmciLCJyZW1vdmVMb2FkaW5nIiwiY2xvc2UiLCJ0cmFuc2FjdGlvbklkIiwiZGlhbG9nSWQiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCIkZGlhbG9nIiwic2V0QXR0cmlidXRlIiwiJGRpYWxvZ0JhY2tkcm9wIiwiJGRpYWxvZ0NvbnRlbnQiLCIkZGlhbG9nTG9hZGluZyIsIiRpZnJhbWUiLCJodG1sIiwiYWNzVXJsIiwiY3JlcSIsInRocmVlRFNTZXNzaW9uRGF0YSIsInJlZGlyZWN0VXJsIiwiY29udGVudFdpbmRvdyIsIndyaXRlIiwiY3JlYXRlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/js/payments/opayo.js\n");

/***/ }),

/***/ "./src/js/payments/payment-provider.js":
/*!*********************************************!*\
  !*** ./src/js/payments/payment-provider.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"FormiePaymentProvider\": () => (/* binding */ FormiePaymentProvider)\n/* harmony export */ });\n/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/utils */ \"./src/js/utils/utils.js\");\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\n\nvar FormiePaymentProvider = /*#__PURE__*/function () {\n  function FormiePaymentProvider() {\n    var _this = this;\n\n    var settings = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, FormiePaymentProvider);\n\n    this.initialized = false;\n    this.$form = settings.$form;\n    this.form = this.$form.form;\n    this.$field = settings.$field;\n    this.successClass = this.form.getClasses('success');\n    this.successMessageClass = this.form.getClasses('successMessage');\n    this.errorClass = this.form.getClasses('error');\n    this.errorMessageClass = this.form.getClasses('errorMessage');\n    this.isVisible = false; // Only initialize the field if it's visible. Use `IntersectionObserver` to check when visible\n    // and also when hidden (navigating to other pages) to destroy it.\n\n    var observer = new IntersectionObserver(function (entries) {\n      if (entries[0].intersectionRatio == 0) {\n        _this.isVisible = false; // Only call the events if ready\n\n        if (_this.initialized) {\n          _this.onHide();\n        }\n      } else {\n        _this.isVisible = true; // Only call the events if ready\n\n        if (_this.initialized) {\n          _this.onShow();\n        }\n      }\n    }, {\n      root: this.$form\n    }); // Watch for when the input is visible/hidden, in the context of the form. But wait a little to start watching\n    // to prevent double binding when still loading the form, or hidden behind conditions.\n\n    setTimeout(function () {\n      observer.observe(_this.$field);\n    }, 500);\n  }\n\n  _createClass(FormiePaymentProvider, [{\n    key: \"removeSuccess\",\n    value: function removeSuccess() {\n      this.$field.classList.remove(this.successClass);\n      var $success = this.$field.querySelector(\".\".concat(this.successMessageClass));\n\n      if ($success) {\n        $success.remove();\n      }\n    }\n  }, {\n    key: \"addSuccess\",\n    value: function addSuccess(message) {\n      this.$field.classList.add(this.successClass);\n      var $fieldContainer = this.$field.querySelector('[data-field-type] > div');\n\n      if (!$fieldContainer) {\n        return console.error('Unable to find `[data-field-type] > div` to add success message.');\n      }\n\n      var $success = document.createElement('div');\n      $success.className = this.successMessageClass;\n      $success.textContent = message;\n      $fieldContainer.appendChild($success);\n    }\n  }, {\n    key: \"removeError\",\n    value: function removeError() {\n      this.$field.classList.remove(this.errorClass);\n      var $error = this.$field.querySelector(\".\".concat(this.errorMessageClass));\n\n      if ($error) {\n        $error.remove();\n      }\n    }\n  }, {\n    key: \"addError\",\n    value: function addError(message) {\n      this.$field.classList.add(this.errorClass);\n      var $fieldContainer = this.$field.querySelector('[data-field-type] > div');\n\n      if (!$fieldContainer) {\n        return console.error('Unable to find `[data-field-type] > div` to add error message.');\n      }\n\n      var $error = document.createElement('div');\n      $error.className = this.errorMessageClass;\n      $error.textContent = message;\n      $fieldContainer.appendChild($error);\n\n      if (this.submitHandler) {\n        this.submitHandler.formSubmitError();\n      }\n    }\n  }, {\n    key: \"updateInputs\",\n    value: function updateInputs(name, value) {\n      var $input = this.$field.querySelector(\"[name*=\\\"\".concat(name, \"\\\"]\"));\n\n      if ($input) {\n        $input.value = value;\n      }\n    }\n  }, {\n    key: \"getBillingData\",\n    value: function getBillingData() {\n      if (!this.billingDetails) {\n        return {};\n      }\n\n      var billing = {};\n\n      if (this.billingDetails.billingName) {\n        var billingName = this.getFieldValue(this.billingDetails.billingName);\n\n        if (billingName) {\n          billing.name = billingName;\n        }\n      }\n\n      if (this.billingDetails.billingEmail) {\n        var billingEmail = this.getFieldValue(this.billingDetails.billingEmail);\n\n        if (billingEmail) {\n          billing.email = billingEmail;\n        }\n      }\n\n      if (this.billingDetails.billingAddress) {\n        billing.address = {};\n        var address1 = this.getFieldValue(\"\".concat(this.billingDetails.billingAddress, \"[address1]\"));\n        var address2 = this.getFieldValue(\"\".concat(this.billingDetails.billingAddress, \"[address2]\"));\n        var address3 = this.getFieldValue(\"\".concat(this.billingDetails.billingAddress, \"[address3]\"));\n        var city = this.getFieldValue(\"\".concat(this.billingDetails.billingAddress, \"[city]\"));\n        var zip = this.getFieldValue(\"\".concat(this.billingDetails.billingAddress, \"[zip]\"));\n        var state = this.getFieldValue(\"\".concat(this.billingDetails.billingAddress, \"[state]\"));\n        var country = this.getFieldValue(\"\".concat(this.billingDetails.billingAddress, \"[country]\"));\n        /* eslint-disable camelcase */\n\n        if (address1) {\n          billing.address.line1 = address1;\n        }\n\n        if (address2) {\n          billing.address.line2 = address2;\n        }\n\n        if (address3) {\n          billing.address.line3 = address3;\n        }\n\n        if (city) {\n          billing.address.city = city;\n        }\n\n        if (zip) {\n          billing.address.postal_code = zip;\n        }\n\n        if (state) {\n          billing.address.state = state;\n        }\n\n        if (country) {\n          billing.address.country = country;\n        }\n        /* eslint-enable camelcase */\n\n      } // Emit an \"modifyBillingDetails\" event. This can directly modify the `billing` param\n\n\n      var modifyBillingDetailsEvent = new CustomEvent('modifyBillingDetails', {\n        bubbles: true,\n        detail: {\n          provider: this,\n          billing: billing\n        }\n      }); // eslint-disable-next-line camelcase\n\n      return {\n        billing_details: billing\n      };\n    }\n  }, {\n    key: \"getFieldValue\",\n    value: function getFieldValue(handle) {\n      var value = '';\n      handle = this.getFieldName(handle); // We'll always get back multiple inputs to normalise checkbox/radios\n\n      var $fields = this.getFormField(handle);\n\n      if ($fields) {\n        $fields.forEach(function ($field) {\n          if ($field.type === 'checkbox' || $field.type === 'radio') {\n            if ($field.checked) {\n              return value = $field.value;\n            }\n          } else {\n            return value = $field.value;\n          }\n        });\n      }\n\n      return value;\n    }\n  }, {\n    key: \"getFormField\",\n    value: function getFormField(handle) {\n      // Get the field(s) we're targeting to watch for changes. Note we need to handle multiple fields (checkboxes)\n      var $fields = this.$form.querySelectorAll(\"[name=\\\"\".concat(handle, \"\\\"]\")); // Check if we're dealing with multiple fields, like checkboxes. This overrides the above\n\n      var $multiFields = this.$form.querySelectorAll(\"[name=\\\"\".concat(handle, \"[]\\\"]\"));\n\n      if ($multiFields.length) {\n        $fields = $multiFields;\n      }\n\n      return $fields;\n    }\n  }, {\n    key: \"getFieldName\",\n    value: function getFieldName(handle) {\n      // Normalise the handle first\n      handle = handle.replace('{', '').replace('}', '').replace(']', '').split('[').join('][');\n      return \"fields[\".concat(handle, \"]\");\n    }\n  }, {\n    key: \"onShow\",\n    value: function onShow() {}\n  }, {\n    key: \"onHide\",\n    value: function onHide() {}\n  }]);\n\n  return FormiePaymentProvider;\n}();\nwindow.FormiePaymentProvider = FormiePaymentProvider;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFnRSxHQUFoRSxFQUFxRUMsSUFBckUsQ0FBMEUsSUFBMUUsQ0FBVDtNQUVBLHdCQUFpQlosTUFBakI7SUFDSDtFQS9OTDtJQUFBO0lBQUEsT0FpT0ksa0JBQVMsQ0FFUjtFQW5PTDtJQUFBO0lBQUEsT0FxT0ksa0JBQVMsQ0FFUjtFQXZPTDs7RUFBQTtBQUFBO0FBME9BYSxNQUFNLENBQUMvRSxxQkFBUCxHQUErQkEscUJBQS9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2pzL3BheW1lbnRzL3BheW1lbnQtcHJvdmlkZXIuanM/YjVmMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBldmVudEtleSB9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIEZvcm1pZVBheW1lbnRQcm92aWRlciB7XG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3MgPSB7fSkge1xuICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuJGZvcm0gPSBzZXR0aW5ncy4kZm9ybTtcbiAgICAgICAgdGhpcy5mb3JtID0gdGhpcy4kZm9ybS5mb3JtO1xuICAgICAgICB0aGlzLiRmaWVsZCA9IHNldHRpbmdzLiRmaWVsZDtcbiAgICAgICAgdGhpcy5zdWNjZXNzQ2xhc3MgPSB0aGlzLmZvcm0uZ2V0Q2xhc3Nlcygnc3VjY2VzcycpO1xuICAgICAgICB0aGlzLnN1Y2Nlc3NNZXNzYWdlQ2xhc3MgPSB0aGlzLmZvcm0uZ2V0Q2xhc3Nlcygnc3VjY2Vzc01lc3NhZ2UnKTtcbiAgICAgICAgdGhpcy5lcnJvckNsYXNzID0gdGhpcy5mb3JtLmdldENsYXNzZXMoJ2Vycm9yJyk7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlQ2xhc3MgPSB0aGlzLmZvcm0uZ2V0Q2xhc3NlcygnZXJyb3JNZXNzYWdlJyk7XG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2U7XG5cbiAgICAgICAgLy8gT25seSBpbml0aWFsaXplIHRoZSBmaWVsZCBpZiBpdCdzIHZpc2libGUuIFVzZSBgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJgIHRvIGNoZWNrIHdoZW4gdmlzaWJsZVxuICAgICAgICAvLyBhbmQgYWxzbyB3aGVuIGhpZGRlbiAobmF2aWdhdGluZyB0byBvdGhlciBwYWdlcykgdG8gZGVzdHJveSBpdC5cbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoKGVudHJpZXMpID0+IHtcbiAgICAgICAgICAgIGlmIChlbnRyaWVzWzBdLmludGVyc2VjdGlvblJhdGlvID09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgLy8gT25seSBjYWxsIHRoZSBldmVudHMgaWYgcmVhZHlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uSGlkZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgLy8gT25seSBjYWxsIHRoZSBldmVudHMgaWYgcmVhZHlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uU2hvdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgeyByb290OiB0aGlzLiRmb3JtIH0pO1xuXG4gICAgICAgIC8vIFdhdGNoIGZvciB3aGVuIHRoZSBpbnB1dCBpcyB2aXNpYmxlL2hpZGRlbiwgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGZvcm0uIEJ1dCB3YWl0IGEgbGl0dGxlIHRvIHN0YXJ0IHdhdGNoaW5nXG4gICAgICAgIC8vIHRvIHByZXZlbnQgZG91YmxlIGJpbmRpbmcgd2hlbiBzdGlsbCBsb2FkaW5nIHRoZSBmb3JtLCBvciBoaWRkZW4gYmVoaW5kIGNvbmRpdGlvbnMuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLiRmaWVsZCk7XG4gICAgICAgIH0sIDUwMCk7XG4gICAgfVxuXG4gICAgcmVtb3ZlU3VjY2VzcygpIHtcbiAgICAgICAgdGhpcy4kZmllbGQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLnN1Y2Nlc3NDbGFzcyk7XG5cbiAgICAgICAgY29uc3QgJHN1Y2Nlc3MgPSB0aGlzLiRmaWVsZC5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLnN1Y2Nlc3NNZXNzYWdlQ2xhc3N9YCk7XG5cbiAgICAgICAgaWYgKCRzdWNjZXNzKSB7XG4gICAgICAgICAgICAkc3VjY2Vzcy5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFkZFN1Y2Nlc3MobWVzc2FnZSkge1xuICAgICAgICB0aGlzLiRmaWVsZC5jbGFzc0xpc3QuYWRkKHRoaXMuc3VjY2Vzc0NsYXNzKTtcblxuICAgICAgICBjb25zdCAkZmllbGRDb250YWluZXIgPSB0aGlzLiRmaWVsZC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1maWVsZC10eXBlXSA+IGRpdicpO1xuXG4gICAgICAgIGlmICghJGZpZWxkQ29udGFpbmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gY29uc29sZS5lcnJvcignVW5hYmxlIHRvIGZpbmQgYFtkYXRhLWZpZWxkLXR5cGVdID4gZGl2YCB0byBhZGQgc3VjY2VzcyBtZXNzYWdlLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgJHN1Y2Nlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgJHN1Y2Nlc3MuY2xhc3NOYW1lID0gdGhpcy5zdWNjZXNzTWVzc2FnZUNsYXNzO1xuICAgICAgICAkc3VjY2Vzcy50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICAgICAgJGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKCRzdWNjZXNzKTtcbiAgICB9XG5cbiAgICByZW1vdmVFcnJvcigpIHtcbiAgICAgICAgdGhpcy4kZmllbGQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmVycm9yQ2xhc3MpO1xuXG4gICAgICAgIGNvbnN0ICRlcnJvciA9IHRoaXMuJGZpZWxkLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuZXJyb3JNZXNzYWdlQ2xhc3N9YCk7XG5cbiAgICAgICAgaWYgKCRlcnJvcikge1xuICAgICAgICAgICAgJGVycm9yLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWRkRXJyb3IobWVzc2FnZSkge1xuICAgICAgICB0aGlzLiRmaWVsZC5jbGFzc0xpc3QuYWRkKHRoaXMuZXJyb3JDbGFzcyk7XG5cbiAgICAgICAgY29uc3QgJGZpZWxkQ29udGFpbmVyID0gdGhpcy4kZmllbGQucXVlcnlTZWxlY3RvcignW2RhdGEtZmllbGQtdHlwZV0gPiBkaXYnKTtcblxuICAgICAgICBpZiAoISRmaWVsZENvbnRhaW5lcikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUuZXJyb3IoJ1VuYWJsZSB0byBmaW5kIGBbZGF0YS1maWVsZC10eXBlXSA+IGRpdmAgdG8gYWRkIGVycm9yIG1lc3NhZ2UuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCAkZXJyb3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgJGVycm9yLmNsYXNzTmFtZSA9IHRoaXMuZXJyb3JNZXNzYWdlQ2xhc3M7XG4gICAgICAgICRlcnJvci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICAgICAgJGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKCRlcnJvcik7XG5cbiAgICAgICAgaWYgKHRoaXMuc3VibWl0SGFuZGxlcikge1xuICAgICAgICAgICAgdGhpcy5zdWJtaXRIYW5kbGVyLmZvcm1TdWJtaXRFcnJvcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdXBkYXRlSW5wdXRzKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0ICRpbnB1dCA9IHRoaXMuJGZpZWxkLnF1ZXJ5U2VsZWN0b3IoYFtuYW1lKj1cIiR7bmFtZX1cIl1gKTtcblxuICAgICAgICBpZiAoJGlucHV0KSB7XG4gICAgICAgICAgICAkaW5wdXQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEJpbGxpbmdEYXRhKCkge1xuICAgICAgICBpZiAoIXRoaXMuYmlsbGluZ0RldGFpbHMpIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJpbGxpbmcgPSB7fTtcblxuICAgICAgICBpZiAodGhpcy5iaWxsaW5nRGV0YWlscy5iaWxsaW5nTmFtZSkge1xuICAgICAgICAgICAgY29uc3QgYmlsbGluZ05hbWUgPSB0aGlzLmdldEZpZWxkVmFsdWUodGhpcy5iaWxsaW5nRGV0YWlscy5iaWxsaW5nTmFtZSk7XG5cbiAgICAgICAgICAgIGlmIChiaWxsaW5nTmFtZSkge1xuICAgICAgICAgICAgICAgIGJpbGxpbmcubmFtZSA9IGJpbGxpbmdOYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuYmlsbGluZ0RldGFpbHMuYmlsbGluZ0VtYWlsKSB7XG4gICAgICAgICAgICBjb25zdCBiaWxsaW5nRW1haWwgPSB0aGlzLmdldEZpZWxkVmFsdWUodGhpcy5iaWxsaW5nRGV0YWlscy5iaWxsaW5nRW1haWwpO1xuXG4gICAgICAgICAgICBpZiAoYmlsbGluZ0VtYWlsKSB7XG4gICAgICAgICAgICAgICAgYmlsbGluZy5lbWFpbCA9IGJpbGxpbmdFbWFpbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmJpbGxpbmdEZXRhaWxzLmJpbGxpbmdBZGRyZXNzKSB7XG4gICAgICAgICAgICBiaWxsaW5nLmFkZHJlc3MgPSB7fTtcblxuICAgICAgICAgICAgY29uc3QgYWRkcmVzczEgPSB0aGlzLmdldEZpZWxkVmFsdWUoYCR7dGhpcy5iaWxsaW5nRGV0YWlscy5iaWxsaW5nQWRkcmVzc31bYWRkcmVzczFdYCk7XG4gICAgICAgICAgICBjb25zdCBhZGRyZXNzMiA9IHRoaXMuZ2V0RmllbGRWYWx1ZShgJHt0aGlzLmJpbGxpbmdEZXRhaWxzLmJpbGxpbmdBZGRyZXNzfVthZGRyZXNzMl1gKTtcbiAgICAgICAgICAgIGNvbnN0IGFkZHJlc3MzID0gdGhpcy5nZXRGaWVsZFZhbHVlKGAke3RoaXMuYmlsbGluZ0RldGFpbHMuYmlsbGluZ0FkZHJlc3N9W2FkZHJlc3MzXWApO1xuICAgICAgICAgICAgY29uc3QgY2l0eSA9IHRoaXMuZ2V0RmllbGRWYWx1ZShgJHt0aGlzLmJpbGxpbmdEZXRhaWxzLmJpbGxpbmdBZGRyZXNzfVtjaXR5XWApO1xuICAgICAgICAgICAgY29uc3QgemlwID0gdGhpcy5nZXRGaWVsZFZhbHVlKGAke3RoaXMuYmlsbGluZ0RldGFpbHMuYmlsbGluZ0FkZHJlc3N9W3ppcF1gKTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5nZXRGaWVsZFZhbHVlKGAke3RoaXMuYmlsbGluZ0RldGFpbHMuYmlsbGluZ0FkZHJlc3N9W3N0YXRlXWApO1xuICAgICAgICAgICAgY29uc3QgY291bnRyeSA9IHRoaXMuZ2V0RmllbGRWYWx1ZShgJHt0aGlzLmJpbGxpbmdEZXRhaWxzLmJpbGxpbmdBZGRyZXNzfVtjb3VudHJ5XWApO1xuXG4gICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cbiAgICAgICAgICAgIGlmIChhZGRyZXNzMSkge1xuICAgICAgICAgICAgICAgIGJpbGxpbmcuYWRkcmVzcy5saW5lMSA9IGFkZHJlc3MxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYWRkcmVzczIpIHtcbiAgICAgICAgICAgICAgICBiaWxsaW5nLmFkZHJlc3MubGluZTIgPSBhZGRyZXNzMjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGFkZHJlc3MzKSB7XG4gICAgICAgICAgICAgICAgYmlsbGluZy5hZGRyZXNzLmxpbmUzID0gYWRkcmVzczM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjaXR5KSB7XG4gICAgICAgICAgICAgICAgYmlsbGluZy5hZGRyZXNzLmNpdHkgPSBjaXR5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoemlwKSB7XG4gICAgICAgICAgICAgICAgYmlsbGluZy5hZGRyZXNzLnBvc3RhbF9jb2RlID0gemlwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBiaWxsaW5nLmFkZHJlc3Muc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBiaWxsaW5nLmFkZHJlc3MuY291bnRyeSA9IGNvdW50cnk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIGNhbWVsY2FzZSAqL1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRW1pdCBhbiBcIm1vZGlmeUJpbGxpbmdEZXRhaWxzXCIgZXZlbnQuIFRoaXMgY2FuIGRpcmVjdGx5IG1vZGlmeSB0aGUgYGJpbGxpbmdgIHBhcmFtXG4gICAgICAgIGNvbnN0IG1vZGlmeUJpbGxpbmdEZXRhaWxzRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ21vZGlmeUJpbGxpbmdEZXRhaWxzJywge1xuICAgICAgICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICAgIHByb3ZpZGVyOiB0aGlzLFxuICAgICAgICAgICAgICAgIGJpbGxpbmcsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgICAgIHJldHVybiB7IGJpbGxpbmdfZGV0YWlsczogYmlsbGluZyB9O1xuICAgIH1cblxuICAgIGdldEZpZWxkVmFsdWUoaGFuZGxlKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9ICcnO1xuXG4gICAgICAgIGhhbmRsZSA9IHRoaXMuZ2V0RmllbGROYW1lKGhhbmRsZSk7XG5cbiAgICAgICAgLy8gV2UnbGwgYWx3YXlzIGdldCBiYWNrIG11bHRpcGxlIGlucHV0cyB0byBub3JtYWxpc2UgY2hlY2tib3gvcmFkaW9zXG4gICAgICAgIGNvbnN0ICRmaWVsZHMgPSB0aGlzLmdldEZvcm1GaWVsZChoYW5kbGUpO1xuXG4gICAgICAgIGlmICgkZmllbGRzKSB7XG4gICAgICAgICAgICAkZmllbGRzLmZvckVhY2goKCRmaWVsZCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICgkZmllbGQudHlwZSA9PT0gJ2NoZWNrYm94JyB8fCAkZmllbGQudHlwZSA9PT0gJ3JhZGlvJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJGZpZWxkLmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSA9ICRmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSA9ICRmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBnZXRGb3JtRmllbGQoaGFuZGxlKSB7XG4gICAgICAgIC8vIEdldCB0aGUgZmllbGQocykgd2UncmUgdGFyZ2V0aW5nIHRvIHdhdGNoIGZvciBjaGFuZ2VzLiBOb3RlIHdlIG5lZWQgdG8gaGFuZGxlIG11bHRpcGxlIGZpZWxkcyAoY2hlY2tib3hlcylcbiAgICAgICAgbGV0ICRmaWVsZHMgPSB0aGlzLiRmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoYFtuYW1lPVwiJHtoYW5kbGV9XCJdYCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgd2UncmUgZGVhbGluZyB3aXRoIG11bHRpcGxlIGZpZWxkcywgbGlrZSBjaGVja2JveGVzLiBUaGlzIG92ZXJyaWRlcyB0aGUgYWJvdmVcbiAgICAgICAgY29uc3QgJG11bHRpRmllbGRzID0gdGhpcy4kZm9ybS5xdWVyeVNlbGVjdG9yQWxsKGBbbmFtZT1cIiR7aGFuZGxlfVtdXCJdYCk7XG5cbiAgICAgICAgaWYgKCRtdWx0aUZpZWxkcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICRmaWVsZHMgPSAkbXVsdGlGaWVsZHM7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gJGZpZWxkcztcbiAgICB9XG5cbiAgICBnZXRGaWVsZE5hbWUoaGFuZGxlKSB7XG4gICAgICAgIC8vIE5vcm1hbGlzZSB0aGUgaGFuZGxlIGZpcnN0XG4gICAgICAgIGhhbmRsZSA9IGhhbmRsZS5yZXBsYWNlKCd7JywgJycpLnJlcGxhY2UoJ30nLCAnJykucmVwbGFjZSgnXScsICcnKS5zcGxpdCgnWycpLmpvaW4oJ11bJyk7XG5cbiAgICAgICAgcmV0dXJuIGBmaWVsZHNbJHtoYW5kbGV9XWA7XG4gICAgfVxuXG4gICAgb25TaG93KCkge1xuXG4gICAgfVxuXG4gICAgb25IaWRlKCkge1xuXG4gICAgfVxufVxuXG53aW5kb3cuRm9ybWllUGF5bWVudFByb3ZpZGVyID0gRm9ybWllUGF5bWVudFByb3ZpZGVyO1xuIl0sIm5hbWVzIjpbImV2ZW50S2V5IiwiRm9ybWllUGF5bWVudFByb3ZpZGVyIiwic2V0dGluZ3MiLCJpbml0aWFsaXplZCIsIiRmb3JtIiwiZm9ybSIsIiRmaWVsZCIsInN1Y2Nlc3NDbGFzcyIsImdldENsYXNzZXMiLCJzdWNjZXNzTWVzc2FnZUNsYXNzIiwiZXJyb3JDbGFzcyIsImVycm9yTWVzc2FnZUNsYXNzIiwiaXNWaXNpYmxlIiwib2JzZXJ2ZXIiLCJJbnRlcnNlY3Rpb25PYnNlcnZlciIsImVudHJpZXMiLCJpbnRlcnNlY3Rpb25SYXRpbyIsIm9uSGlkZSIsIm9uU2hvdyIsInJvb3QiLCJzZXRUaW1lb3V0Iiwib2JzZXJ2ZSIsImNsYXNzTGlzdCIsInJlbW92ZSIsIiRzdWNjZXNzIiwicXVlcnlTZWxlY3RvciIsIm1lc3NhZ2UiLCJhZGQiLCIkZmllbGRDb250YWluZXIiLCJjb25zb2xlIiwiZXJyb3IiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJ0ZXh0Q29udGVudCIsImFwcGVuZENoaWxkIiwiJGVycm9yIiwic3VibWl0SGFuZGxlciIsImZvcm1TdWJtaXRFcnJvciIsIm5hbWUiLCJ2YWx1ZSIsIiRpbnB1dCIsImJpbGxpbmdEZXRhaWxzIiwiYmlsbGluZyIsImJpbGxpbmdOYW1lIiwiZ2V0RmllbGRWYWx1ZSIsImJpbGxpbmdFbWFpbCIsImVtYWlsIiwiYmlsbGluZ0FkZHJlc3MiLCJhZGRyZXNzIiwiYWRkcmVzczEiLCJhZGRyZXNzMiIsImFkZHJlc3MzIiwiY2l0eSIsInppcCIsInN0YXRlIiwiY291bnRyeSIsImxpbmUxIiwibGluZTIiLCJsaW5lMyIsInBvc3RhbF9jb2RlIiwibW9kaWZ5QmlsbGluZ0RldGFpbHNFdmVudCIsIkN1c3RvbUV2ZW50IiwiYnViYmxlcyIsImRldGFpbCIsInByb3ZpZGVyIiwiYmlsbGluZ19kZXRhaWxzIiwiaGFuZGxlIiwiZ2V0RmllbGROYW1lIiwiJGZpZWxkcyIsImdldEZvcm1GaWVsZCIsImZvckVhY2giLCJ0eXBlIiwiY2hlY2tlZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCIkbXVsdGlGaWVsZHMiLCJsZW5ndGgiLCJyZXBsYWNlIiwic3BsaXQiLCJqb2luIiwid2luZG93Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/js/payments/payment-provider.js\n");

/***/ }),

/***/ "./src/js/utils/utils.js":
/*!*******************************!*\
  !*** ./src/js/utils/utils.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"eventKey\": () => (/* binding */ eventKey),\n/* harmony export */   \"isEmpty\": () => (/* binding */ isEmpty),\n/* harmony export */   \"toBoolean\": () => (/* binding */ toBoolean)\n/* harmony export */ });\nvar isEmpty = function isEmpty(obj) {\n  return obj && Object.keys(obj).length === 0 && obj.constructor === Object;\n};\nvar toBoolean = function toBoolean(val) {\n  return !/^(?:f(?:alse)?|no?|0+)$/i.test(val) && !!val;\n};\nvar eventKey = function eventKey(eventName) {\n  var namespace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n  if (!namespace) {\n    namespace = Math.random().toString(36).substr(2, 5);\n  }\n\n  return \"\".concat(eventName, \".\").concat(namespace);\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvanMvdXRpbHMvdXRpbHMuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQU8sSUFBTUEsT0FBTyxHQUFHLFNBQVZBLE9BQVUsQ0FBU0MsR0FBVCxFQUFjO0VBQ2pDLE9BQU9BLEdBQUcsSUFBSUMsTUFBTSxDQUFDQyxJQUFQLENBQVlGLEdBQVosRUFBaUJHLE1BQWpCLEtBQTRCLENBQW5DLElBQXdDSCxHQUFHLENBQUNJLFdBQUosS0FBb0JILE1BQW5FO0FBQ0gsQ0FGTTtBQUlBLElBQU1JLFNBQVMsR0FBRyxTQUFaQSxTQUFZLENBQVNDLEdBQVQsRUFBYztFQUNuQyxPQUFPLENBQUMsMkJBQTJCQyxJQUEzQixDQUFnQ0QsR0FBaEMsQ0FBRCxJQUF5QyxDQUFDLENBQUNBLEdBQWxEO0FBQ0gsQ0FGTTtBQUlBLElBQU1FLFFBQVEsR0FBRyxTQUFYQSxRQUFXLENBQVNDLFNBQVQsRUFBc0M7RUFBQSxJQUFsQkMsU0FBa0IsdUVBQU4sSUFBTTs7RUFDMUQsSUFBSSxDQUFDQSxTQUFMLEVBQWdCO0lBQ1pBLFNBQVMsR0FBR0MsSUFBSSxDQUFDQyxNQUFMLEdBQWNDLFFBQWQsQ0FBdUIsRUFBdkIsRUFBMkJDLE1BQTNCLENBQWtDLENBQWxDLEVBQXFDLENBQXJDLENBQVo7RUFDSDs7RUFFRCxpQkFBVUwsU0FBVixjQUF1QkMsU0FBdkI7QUFDSCxDQU5NIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2pzL3V0aWxzL3V0aWxzLmpzP2Q5ZWUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGlzRW1wdHkgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gb2JqICYmIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0O1xufTtcblxuZXhwb3J0IGNvbnN0IHRvQm9vbGVhbiA9IGZ1bmN0aW9uKHZhbCkge1xuICAgIHJldHVybiAhL14oPzpmKD86YWxzZSk/fG5vP3wwKykkL2kudGVzdCh2YWwpICYmICEhdmFsO1xufTtcblxuZXhwb3J0IGNvbnN0IGV2ZW50S2V5ID0gZnVuY3Rpb24oZXZlbnROYW1lLCBuYW1lc3BhY2UgPSBudWxsKSB7XG4gICAgaWYgKCFuYW1lc3BhY2UpIHtcbiAgICAgICAgbmFtZXNwYWNlID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDUpO1xuICAgIH1cblxuICAgIHJldHVybiBgJHtldmVudE5hbWV9LiR7bmFtZXNwYWNlfWA7XG59O1xuIl0sIm5hbWVzIjpbImlzRW1wdHkiLCJvYmoiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiY29uc3RydWN0b3IiLCJ0b0Jvb2xlYW4iLCJ2YWwiLCJ0ZXN0IiwiZXZlbnRLZXkiLCJldmVudE5hbWUiLCJuYW1lc3BhY2UiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/js/utils/utils.js\n");

/***/ }),

/***/ "../../../../node_modules/globalthis/implementation.browser.js":
/*!*********************************************************************!*\
  !*** ../../../../node_modules/globalthis/implementation.browser.js ***!
  \*********************************************************************/
/***/ ((module) => {

"use strict";
eval("/* eslint no-negated-condition: 0, no-new-func: 0 */\n\n\n\nif (typeof self !== 'undefined') {\n\tmodule.exports = self;\n} else if (typeof window !== 'undefined') {\n\tmodule.exports = window;\n} else {\n\tmodule.exports = Function('return this')();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2dsb2JhbHRoaXMvaW1wbGVtZW50YXRpb24uYnJvd3Nlci5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBQTs7QUFFYTs7QUFFYjtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0EsRUFBRTtBQUNGO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2dsb2JhbHRoaXMvaW1wbGVtZW50YXRpb24uYnJvd3Nlci5qcz8wMWVhIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludCBuby1uZWdhdGVkLWNvbmRpdGlvbjogMCwgbm8tbmV3LWZ1bmM6IDAgKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5pZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG5cdG1vZHVsZS5leHBvcnRzID0gc2VsZjtcbn0gZWxzZSBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0bW9kdWxlLmV4cG9ydHMgPSB3aW5kb3c7XG59IGVsc2Uge1xuXHRtb2R1bGUuZXhwb3J0cyA9IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../../../../node_modules/globalthis/implementation.browser.js\n");

/***/ }),

/***/ "../../../../node_modules/globalthis/polyfill.js":
/*!*******************************************************!*\
  !*** ../../../../node_modules/globalthis/polyfill.js ***!
  \*******************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar implementation = __webpack_require__(/*! ./implementation */ \"../../../../node_modules/globalthis/implementation.browser.js\");\n\nmodule.exports = function getPolyfill() {\n\tif (typeof __webpack_require__.g !== 'object' || !__webpack_require__.g || __webpack_require__.g.Math !== Math || __webpack_require__.g.Array !== Array) {\n\t\treturn implementation;\n\t}\n\treturn __webpack_require__.g;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2dsb2JhbHRoaXMvcG9seWZpbGwuanMuanMiLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIscUJBQXFCLG1CQUFPLENBQUMsdUZBQWtCOztBQUUvQztBQUNBLFlBQVkscUJBQU0sa0JBQWtCLHFCQUFNLElBQUkscUJBQU0sa0JBQWtCLHFCQUFNO0FBQzVFO0FBQ0E7QUFDQSxRQUFRLHFCQUFNO0FBQ2QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2dsb2JhbHRoaXMvcG9seWZpbGwuanM/YjhjYiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBpbXBsZW1lbnRhdGlvbiA9IHJlcXVpcmUoJy4vaW1wbGVtZW50YXRpb24nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRQb2x5ZmlsbCgpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWwgIT09ICdvYmplY3QnIHx8ICFnbG9iYWwgfHwgZ2xvYmFsLk1hdGggIT09IE1hdGggfHwgZ2xvYmFsLkFycmF5ICE9PSBBcnJheSkge1xuXHRcdHJldHVybiBpbXBsZW1lbnRhdGlvbjtcblx0fVxuXHRyZXR1cm4gZ2xvYmFsO1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../../../../node_modules/globalthis/polyfill.js\n");

/***/ }),

/***/ "../../../../node_modules/payment/lib/index.js":
/*!*****************************************************!*\
  !*** ../../../../node_modules/payment/lib/index.js ***!
  \*****************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

eval("// Generated by CoffeeScript 1.12.7\n(function() {\n  var Payment, QJ, cardFromNumber, cardFromType, cards, cursorSafeAssignValue, defaultFormat, formatBackCardNumber, formatBackExpiry, formatCardNumber, formatExpiry, formatForwardExpiry, formatForwardSlash, formatMonthExpiry, globalThis, hasTextSelected, luhnCheck, reFormatCardNumber, restrictCVC, restrictCardNumber, restrictCombinedExpiry, restrictExpiry, restrictMonthExpiry, restrictNumeric, restrictYearExpiry, setCardType,\n    indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\n  globalThis = __webpack_require__(/*! globalthis/polyfill */ \"../../../../node_modules/globalthis/polyfill.js\")();\n\n  QJ = __webpack_require__(/*! qj */ \"../../../../node_modules/qj/lib/index.js\");\n\n  defaultFormat = /(\\d{1,4})/g;\n\n  cards = [\n    {\n      type: 'amex',\n      pattern: /^3[47]/,\n      format: /(\\d{1,4})(\\d{1,6})?(\\d{1,5})?/,\n      length: [15],\n      cvcLength: [4],\n      luhn: true\n    }, {\n      type: 'dankort',\n      pattern: /^5019/,\n      format: defaultFormat,\n      length: [16],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'dinersclub',\n      pattern: /^(36|38|30[0-5])/,\n      format: /(\\d{1,4})(\\d{1,6})?(\\d{1,4})?/,\n      length: [14],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'discover',\n      pattern: /^(6011|65|64[4-9]|622)/,\n      format: defaultFormat,\n      length: [16],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'elo',\n      pattern: /^401178|^401179|^431274|^438935|^451416|^457393|^457631|^457632|^504175|^627780|^636297|^636369|^636368|^(506699|5067[0-6]\\d|50677[0-8])|^(50900\\d|5090[1-9]\\d|509[1-9]\\d{2})|^65003[1-3]|^(65003[5-9]|65004\\d|65005[0-1])|^(65040[5-9]|6504[1-3]\\d)|^(65048[5-9]|65049\\d|6505[0-2]\\d|65053[0-8])|^(65054[1-9]|6505[5-8]\\d|65059[0-8])|^(65070\\d|65071[0-8])|^65072[0-7]|^(65090[1-9]|65091\\d|650920)|^(65165[2-9]|6516[6-7]\\d)|^(65500\\d|65501\\d)|^(65502[1-9]|6550[3-4]\\d|65505[0-8])|^(65092[1-9]|65097[0-8])/,\n      format: defaultFormat,\n      length: [16],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'hipercard',\n      pattern: /^(384100|384140|384160|606282|637095|637568|60(?!11))/,\n      format: defaultFormat,\n      length: [14, 15, 16, 17, 18, 19],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'jcb',\n      pattern: /^(308[8-9]|309[0-3]|3094[0]{4}|309[6-9]|310[0-2]|311[2-9]|3120|315[8-9]|333[7-9]|334[0-9]|35)/,\n      format: defaultFormat,\n      length: [16, 19],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'laser',\n      pattern: /^(6706|6771|6709)/,\n      format: defaultFormat,\n      length: [16, 17, 18, 19],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'maestro',\n      pattern: /^(50|5[6-9]|6007|6220|6304|6703|6708|6759|676[1-3])/,\n      format: defaultFormat,\n      length: [12, 13, 14, 15, 16, 17, 18, 19],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'mastercard',\n      pattern: /^(5[1-5]|677189)|^(222[1-9]|2[3-6]\\d{2}|27[0-1]\\d|2720)/,\n      format: defaultFormat,\n      length: [16],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'mir',\n      pattern: /^220[0-4][0-9][0-9]\\d{10}$/,\n      format: defaultFormat,\n      length: [16],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'troy',\n      pattern: /^9792/,\n      format: defaultFormat,\n      length: [16],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'unionpay',\n      pattern: /^62/,\n      format: defaultFormat,\n      length: [16, 17, 18, 19],\n      cvcLength: [3],\n      luhn: false\n    }, {\n      type: 'visaelectron',\n      pattern: /^4(026|17500|405|508|844|91[37])/,\n      format: defaultFormat,\n      length: [16],\n      cvcLength: [3],\n      luhn: true\n    }, {\n      type: 'visa',\n      pattern: /^4/,\n      format: defaultFormat,\n      length: [13, 16],\n      cvcLength: [3],\n      luhn: true\n    }\n  ];\n\n  cardFromNumber = function(num) {\n    var card, foundCard, j, len, match;\n    num = (num + '').replace(/\\D/g, '');\n    foundCard = void 0;\n    for (j = 0, len = cards.length; j < len; j++) {\n      card = cards[j];\n      if (match = num.match(card.pattern)) {\n        if (!foundCard || match[0].length > foundCard[1][0].length) {\n          foundCard = [card, match];\n        }\n      }\n    }\n    return foundCard && foundCard[0];\n  };\n\n  cardFromType = function(type) {\n    var card, j, len;\n    for (j = 0, len = cards.length; j < len; j++) {\n      card = cards[j];\n      if (card.type === type) {\n        return card;\n      }\n    }\n  };\n\n  luhnCheck = function(num) {\n    var digit, digits, j, len, odd, sum;\n    odd = true;\n    sum = 0;\n    digits = (num + '').split('').reverse();\n    for (j = 0, len = digits.length; j < len; j++) {\n      digit = digits[j];\n      digit = parseInt(digit, 10);\n      if ((odd = !odd)) {\n        digit *= 2;\n      }\n      if (digit > 9) {\n        digit -= 9;\n      }\n      sum += digit;\n    }\n    return sum % 10 === 0;\n  };\n\n  hasTextSelected = function(target) {\n    var e, ref;\n    try {\n      if ((target.selectionStart != null) && target.selectionStart !== target.selectionEnd) {\n        return true;\n      }\n      if ((typeof document !== \"undefined\" && document !== null ? (ref = document.selection) != null ? ref.createRange : void 0 : void 0) != null) {\n        if (document.selection.createRange().text) {\n          return true;\n        }\n      }\n    } catch (error) {\n      e = error;\n    }\n    return false;\n  };\n\n  reFormatCardNumber = function(e) {\n    return setTimeout((function(_this) {\n      return function() {\n        var target, value;\n        target = e.target;\n        value = QJ.val(target);\n        value = Payment.fns.formatCardNumber(value);\n        cursorSafeAssignValue(target, value);\n        return QJ.trigger(target, 'change');\n      };\n    })(this));\n  };\n\n  formatCardNumber = function(maxLength) {\n    return function(e) {\n      var card, digit, i, j, len, length, re, target, upperLength, upperLengths, value;\n      if (e.which > 0) {\n        digit = String.fromCharCode(e.which);\n        value = QJ.val(e.target) + digit;\n      } else {\n        digit = e.data;\n        value = QJ.val(e.target);\n      }\n      if (!/^\\d+$/.test(digit)) {\n        return;\n      }\n      target = e.target;\n      card = cardFromNumber(value);\n      length = (value.replace(/\\D/g, '')).length;\n      upperLengths = [16];\n      if (card) {\n        upperLengths = card.length;\n      }\n      if (maxLength) {\n        upperLengths = upperLengths.filter(function(x) {\n          return x <= maxLength;\n        });\n      }\n      for (i = j = 0, len = upperLengths.length; j < len; i = ++j) {\n        upperLength = upperLengths[i];\n        if (length >= upperLength && upperLengths[i + 1]) {\n          continue;\n        }\n        if (length >= upperLength) {\n          return;\n        }\n      }\n      if (hasTextSelected(target)) {\n        return;\n      }\n      if (card && card.type === 'amex') {\n        re = /^(\\d{4}|\\d{4}\\s\\d{6})$/;\n      } else {\n        re = /(?:^|\\s)(\\d{4})$/;\n      }\n      value = value.substring(0, value.length - 1);\n      if (re.test(value)) {\n        e.preventDefault();\n        QJ.val(target, value + ' ' + digit);\n        return QJ.trigger(target, 'change');\n      }\n    };\n  };\n\n  formatBackCardNumber = function(e) {\n    var target, value;\n    target = e.target;\n    value = QJ.val(target);\n    if (e.meta) {\n      return;\n    }\n    if (e.which !== 8) {\n      return;\n    }\n    if (hasTextSelected(target)) {\n      return;\n    }\n    if (/\\d\\s$/.test(value)) {\n      e.preventDefault();\n      QJ.val(target, value.replace(/\\d\\s$/, ''));\n      return QJ.trigger(target, 'change');\n    } else if (/\\s\\d?$/.test(value)) {\n      e.preventDefault();\n      QJ.val(target, value.replace(/\\s\\d?$/, ''));\n      return QJ.trigger(target, 'change');\n    }\n  };\n\n  formatExpiry = function(e) {\n    var digit, target, val;\n    target = e.target;\n    if (e.which > 0) {\n      digit = String.fromCharCode(e.which);\n      val = QJ.val(target) + digit;\n    } else {\n      digit = e.data;\n      val = QJ.val(target);\n    }\n    if (!/^\\d+$/.test(digit)) {\n      return;\n    }\n    if (/^\\d$/.test(val) && (val !== '0' && val !== '1')) {\n      e.preventDefault();\n      QJ.val(target, \"0\" + val + \" / \");\n      return QJ.trigger(target, 'change');\n    } else if (/^\\d\\d$/.test(val)) {\n      e.preventDefault();\n      QJ.val(target, val + \" / \");\n      return QJ.trigger(target, 'change');\n    }\n  };\n\n  formatMonthExpiry = function(e) {\n    var digit, target, val;\n    digit = String.fromCharCode(e.which);\n    if (!/^\\d+$/.test(digit)) {\n      return;\n    }\n    target = e.target;\n    val = QJ.val(target) + digit;\n    if (/^\\d$/.test(val) && (val !== '0' && val !== '1')) {\n      e.preventDefault();\n      QJ.val(target, \"0\" + val);\n      return QJ.trigger(target, 'change');\n    } else if (/^\\d\\d$/.test(val)) {\n      e.preventDefault();\n      QJ.val(target, \"\" + val);\n      return QJ.trigger(target, 'change');\n    }\n  };\n\n  formatForwardExpiry = function(e) {\n    var digit, target, val;\n    digit = String.fromCharCode(e.which);\n    if (!/^\\d+$/.test(digit)) {\n      return;\n    }\n    target = e.target;\n    val = QJ.val(target);\n    if (/^\\d\\d$/.test(val)) {\n      QJ.val(target, val + \" / \");\n      return QJ.trigger(target, 'change');\n    }\n  };\n\n  formatForwardSlash = function(e) {\n    var slash, target, val;\n    slash = String.fromCharCode(e.which);\n    if (slash !== '/') {\n      return;\n    }\n    target = e.target;\n    val = QJ.val(target);\n    if (/^\\d$/.test(val) && val !== '0') {\n      QJ.val(target, \"0\" + val + \" / \");\n      return QJ.trigger(target, 'change');\n    }\n  };\n\n  formatBackExpiry = function(e) {\n    var target, value;\n    if (e.metaKey) {\n      return;\n    }\n    target = e.target;\n    value = QJ.val(target);\n    if (e.which !== 8) {\n      return;\n    }\n    if (hasTextSelected(target)) {\n      return;\n    }\n    if (/\\d(\\s|\\/)+$/.test(value)) {\n      e.preventDefault();\n      QJ.val(target, value.replace(/\\d(\\s|\\/)*$/, ''));\n      return QJ.trigger(target, 'change');\n    } else if (/\\s\\/\\s?\\d?$/.test(value)) {\n      e.preventDefault();\n      QJ.val(target, value.replace(/\\s\\/\\s?\\d?$/, ''));\n      return QJ.trigger(target, 'change');\n    }\n  };\n\n  restrictNumeric = function(e) {\n    var input;\n    if (e.metaKey || e.ctrlKey) {\n      return true;\n    }\n    if (e.which === 32) {\n      return e.preventDefault();\n    }\n    if (e.which === 0) {\n      return true;\n    }\n    if (e.which < 33) {\n      return true;\n    }\n    input = String.fromCharCode(e.which);\n    if (!/[\\d\\s]/.test(input)) {\n      return e.preventDefault();\n    }\n  };\n\n  restrictCardNumber = function(maxLength) {\n    return function(e) {\n      var card, digit, length, target, value;\n      target = e.target;\n      digit = String.fromCharCode(e.which);\n      if (!/^\\d+$/.test(digit)) {\n        return;\n      }\n      if (hasTextSelected(target)) {\n        return;\n      }\n      value = (QJ.val(target) + digit).replace(/\\D/g, '');\n      card = cardFromNumber(value);\n      length = 16;\n      if (card) {\n        length = card.length[card.length.length - 1];\n      }\n      if (maxLength) {\n        length = Math.min(length, maxLength);\n      }\n      if (!(value.length <= length)) {\n        return e.preventDefault();\n      }\n    };\n  };\n\n  restrictExpiry = function(e, length) {\n    var digit, target, value;\n    target = e.target;\n    digit = String.fromCharCode(e.which);\n    if (!/^\\d+$/.test(digit)) {\n      return;\n    }\n    if (hasTextSelected(target)) {\n      return;\n    }\n    value = QJ.val(target) + digit;\n    value = value.replace(/\\D/g, '');\n    if (value.length > length) {\n      return e.preventDefault();\n    }\n  };\n\n  restrictCombinedExpiry = function(e) {\n    return restrictExpiry(e, 6);\n  };\n\n  restrictMonthExpiry = function(e) {\n    return restrictExpiry(e, 2);\n  };\n\n  restrictYearExpiry = function(e) {\n    return restrictExpiry(e, 4);\n  };\n\n  restrictCVC = function(e) {\n    var digit, target, val;\n    target = e.target;\n    digit = String.fromCharCode(e.which);\n    if (!/^\\d+$/.test(digit)) {\n      return;\n    }\n    if (hasTextSelected(target)) {\n      return;\n    }\n    val = QJ.val(target) + digit;\n    if (!(val.length <= 4)) {\n      return e.preventDefault();\n    }\n  };\n\n  setCardType = function(e) {\n    var allTypes, card, cardType, target, val;\n    target = e.target;\n    val = QJ.val(target);\n    cardType = Payment.fns.cardType(val) || 'unknown';\n    if (!QJ.hasClass(target, cardType)) {\n      allTypes = (function() {\n        var j, len, results;\n        results = [];\n        for (j = 0, len = cards.length; j < len; j++) {\n          card = cards[j];\n          results.push(card.type);\n        }\n        return results;\n      })();\n      QJ.removeClass(target, 'unknown');\n      QJ.removeClass(target, allTypes.join(' '));\n      QJ.addClass(target, cardType);\n      QJ.toggleClass(target, 'identified', cardType !== 'unknown');\n      return QJ.trigger(target, 'payment.cardType', cardType);\n    }\n  };\n\n  cursorSafeAssignValue = function(target, value) {\n    var selectionEnd;\n    selectionEnd = target.selectionEnd;\n    QJ.val(target, value);\n    if (selectionEnd) {\n      return target.selectionEnd = selectionEnd;\n    }\n  };\n\n  Payment = (function() {\n    function Payment() {}\n\n    Payment.J = QJ;\n\n    Payment.fns = {\n      cardExpiryVal: function(value) {\n        var month, prefix, ref, year;\n        value = value.replace(/\\s/g, '');\n        ref = value.split('/', 2), month = ref[0], year = ref[1];\n        if ((year != null ? year.length : void 0) === 2 && /^\\d+$/.test(year)) {\n          prefix = (new Date).getFullYear();\n          prefix = prefix.toString().slice(0, 2);\n          year = prefix + year;\n        }\n        month = parseInt(month, 10);\n        year = parseInt(year, 10);\n        return {\n          month: month,\n          year: year\n        };\n      },\n      validateCardNumber: function(num) {\n        var card, ref;\n        num = (num + '').replace(/\\s+|-/g, '');\n        if (!/^\\d+$/.test(num)) {\n          return false;\n        }\n        card = cardFromNumber(num);\n        if (!card) {\n          return false;\n        }\n        return (ref = num.length, indexOf.call(card.length, ref) >= 0) && (card.luhn === false || luhnCheck(num));\n      },\n      validateCardExpiry: function(month, year) {\n        var currentTime, expiry, prefix, ref, ref1;\n        if (typeof month === 'object' && 'month' in month) {\n          ref = month, month = ref.month, year = ref.year;\n        } else if (typeof month === 'string' && indexOf.call(month, '/') >= 0) {\n          ref1 = Payment.fns.cardExpiryVal(month), month = ref1.month, year = ref1.year;\n        }\n        if (!(month && year)) {\n          return false;\n        }\n        month = QJ.trim(month);\n        year = QJ.trim(year);\n        if (!/^\\d+$/.test(month)) {\n          return false;\n        }\n        if (!/^\\d+$/.test(year)) {\n          return false;\n        }\n        month = parseInt(month, 10);\n        if (!(month && month <= 12)) {\n          return false;\n        }\n        if (year.length === 2) {\n          prefix = (new Date).getFullYear();\n          prefix = prefix.toString().slice(0, 2);\n          year = prefix + year;\n        }\n        expiry = new Date(year, month);\n        currentTime = new Date;\n        expiry.setMonth(expiry.getMonth() - 1);\n        expiry.setMonth(expiry.getMonth() + 1, 1);\n        return expiry > currentTime;\n      },\n      validateCardCVC: function(cvc, type) {\n        var ref, ref1;\n        cvc = QJ.trim(cvc);\n        if (!/^\\d+$/.test(cvc)) {\n          return false;\n        }\n        if (type && cardFromType(type)) {\n          return ref = cvc.length, indexOf.call((ref1 = cardFromType(type)) != null ? ref1.cvcLength : void 0, ref) >= 0;\n        } else {\n          return cvc.length >= 3 && cvc.length <= 4;\n        }\n      },\n      cardType: function(num) {\n        var ref;\n        if (!num) {\n          return null;\n        }\n        return ((ref = cardFromNumber(num)) != null ? ref.type : void 0) || null;\n      },\n      formatCardNumber: function(num) {\n        var card, groups, ref, upperLength;\n        card = cardFromNumber(num);\n        if (!card) {\n          return num;\n        }\n        upperLength = card.length[card.length.length - 1];\n        num = num.replace(/\\D/g, '');\n        num = num.slice(0, upperLength);\n        if (card.format.global) {\n          return (ref = num.match(card.format)) != null ? ref.join(' ') : void 0;\n        } else {\n          groups = card.format.exec(num);\n          if (groups == null) {\n            return;\n          }\n          groups.shift();\n          groups = groups.filter(function(n) {\n            return n;\n          });\n          return groups.join(' ');\n        }\n      }\n    };\n\n    Payment.restrictNumeric = function(el) {\n      QJ.on(el, 'keypress', restrictNumeric);\n      return QJ.on(el, 'input', restrictNumeric);\n    };\n\n    Payment.cardExpiryVal = function(el) {\n      return Payment.fns.cardExpiryVal(QJ.val(el));\n    };\n\n    Payment.formatCardCVC = function(el) {\n      Payment.restrictNumeric(el);\n      QJ.on(el, 'keypress', restrictCVC);\n      QJ.on(el, 'input', restrictCVC);\n      return el;\n    };\n\n    Payment.formatCardExpiry = function(el) {\n      var month, year;\n      Payment.restrictNumeric(el);\n      if (el.length && el.length === 2) {\n        month = el[0], year = el[1];\n        this.formatCardExpiryMultiple(month, year);\n      } else {\n        QJ.on(el, 'keypress', restrictCombinedExpiry);\n        QJ.on(el, 'keypress', formatExpiry);\n        QJ.on(el, 'keypress', formatForwardSlash);\n        QJ.on(el, 'keypress', formatForwardExpiry);\n        QJ.on(el, 'keydown', formatBackExpiry);\n        QJ.on(el, 'input', formatExpiry);\n      }\n      return el;\n    };\n\n    Payment.formatCardExpiryMultiple = function(month, year) {\n      QJ.on(month, 'keypress', restrictMonthExpiry);\n      QJ.on(month, 'keypress', formatMonthExpiry);\n      QJ.on(month, 'input', formatMonthExpiry);\n      QJ.on(year, 'keypress', restrictYearExpiry);\n      return QJ.on(year, 'input', restrictYearExpiry);\n    };\n\n    Payment.formatCardNumber = function(el, maxLength) {\n      Payment.restrictNumeric(el);\n      QJ.on(el, 'keypress', restrictCardNumber(maxLength));\n      QJ.on(el, 'keypress', formatCardNumber(maxLength));\n      QJ.on(el, 'keydown', formatBackCardNumber);\n      QJ.on(el, 'keyup blur', setCardType);\n      QJ.on(el, 'blur', formatCardNumber(maxLength));\n      QJ.on(el, 'paste', reFormatCardNumber);\n      QJ.on(el, 'input', formatCardNumber(maxLength));\n      return el;\n    };\n\n    Payment.getCardArray = function() {\n      return cards;\n    };\n\n    Payment.setCardArray = function(cardArray) {\n      cards = cardArray;\n      return true;\n    };\n\n    Payment.addToCardArray = function(cardObject) {\n      return cards.push(cardObject);\n    };\n\n    Payment.removeFromCardArray = function(type) {\n      var key, value;\n      for (key in cards) {\n        value = cards[key];\n        if (value.type === type) {\n          cards.splice(key, 1);\n        }\n      }\n      return true;\n    };\n\n    return Payment;\n\n  })();\n\n  module.exports = Payment;\n\n  globalThis.Payment = Payment;\n\n}).call(this);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3BheW1lbnQvbGliL2luZGV4LmpzLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxpQ0FBaUMsT0FBTyxPQUFPLCtDQUErQzs7QUFFM0ksZUFBZSxtQkFBTyxDQUFDLDRFQUFxQjs7QUFFNUMsT0FBTyxtQkFBTyxDQUFDLG9EQUFJOztBQUVuQix1QkFBdUIsSUFBSTs7QUFFM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsSUFBSSxLQUFLLElBQUksTUFBTSxJQUFJO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLG1CQUFtQixJQUFJLEtBQUssSUFBSSxNQUFNLElBQUk7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDBMQUEwTCxFQUFFO0FBQzVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDRDQUE0QyxFQUFFO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxxREFBcUQsRUFBRTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLHNDQUFzQyxHQUFHO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsU0FBUztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9DQUFvQyxTQUFTO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLFNBQVM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsaURBQWlELFNBQVM7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRTtBQUNsQyxRQUFRO0FBQ1IsMEJBQTBCLEVBQUU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxTQUFTO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3BheW1lbnQvbGliL2luZGV4LmpzPzA2ZDUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjEyLjdcbihmdW5jdGlvbigpIHtcbiAgdmFyIFBheW1lbnQsIFFKLCBjYXJkRnJvbU51bWJlciwgY2FyZEZyb21UeXBlLCBjYXJkcywgY3Vyc29yU2FmZUFzc2lnblZhbHVlLCBkZWZhdWx0Rm9ybWF0LCBmb3JtYXRCYWNrQ2FyZE51bWJlciwgZm9ybWF0QmFja0V4cGlyeSwgZm9ybWF0Q2FyZE51bWJlciwgZm9ybWF0RXhwaXJ5LCBmb3JtYXRGb3J3YXJkRXhwaXJ5LCBmb3JtYXRGb3J3YXJkU2xhc2gsIGZvcm1hdE1vbnRoRXhwaXJ5LCBnbG9iYWxUaGlzLCBoYXNUZXh0U2VsZWN0ZWQsIGx1aG5DaGVjaywgcmVGb3JtYXRDYXJkTnVtYmVyLCByZXN0cmljdENWQywgcmVzdHJpY3RDYXJkTnVtYmVyLCByZXN0cmljdENvbWJpbmVkRXhwaXJ5LCByZXN0cmljdEV4cGlyeSwgcmVzdHJpY3RNb250aEV4cGlyeSwgcmVzdHJpY3ROdW1lcmljLCByZXN0cmljdFllYXJFeHBpcnksIHNldENhcmRUeXBlLFxuICAgIGluZGV4T2YgPSBbXS5pbmRleE9mIHx8IGZ1bmN0aW9uKGl0ZW0pIHsgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykgeyBpZiAoaSBpbiB0aGlzICYmIHRoaXNbaV0gPT09IGl0ZW0pIHJldHVybiBpOyB9IHJldHVybiAtMTsgfTtcblxuICBnbG9iYWxUaGlzID0gcmVxdWlyZSgnZ2xvYmFsdGhpcy9wb2x5ZmlsbCcpKCk7XG5cbiAgUUogPSByZXF1aXJlKCdxaicpO1xuXG4gIGRlZmF1bHRGb3JtYXQgPSAvKFxcZHsxLDR9KS9nO1xuXG4gIGNhcmRzID0gW1xuICAgIHtcbiAgICAgIHR5cGU6ICdhbWV4JyxcbiAgICAgIHBhdHRlcm46IC9eM1s0N10vLFxuICAgICAgZm9ybWF0OiAvKFxcZHsxLDR9KShcXGR7MSw2fSk/KFxcZHsxLDV9KT8vLFxuICAgICAgbGVuZ3RoOiBbMTVdLFxuICAgICAgY3ZjTGVuZ3RoOiBbNF0sXG4gICAgICBsdWhuOiB0cnVlXG4gICAgfSwge1xuICAgICAgdHlwZTogJ2RhbmtvcnQnLFxuICAgICAgcGF0dGVybjogL141MDE5LyxcbiAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgbHVobjogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHR5cGU6ICdkaW5lcnNjbHViJyxcbiAgICAgIHBhdHRlcm46IC9eKDM2fDM4fDMwWzAtNV0pLyxcbiAgICAgIGZvcm1hdDogLyhcXGR7MSw0fSkoXFxkezEsNn0pPyhcXGR7MSw0fSk/LyxcbiAgICAgIGxlbmd0aDogWzE0XSxcbiAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgbHVobjogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHR5cGU6ICdkaXNjb3ZlcicsXG4gICAgICBwYXR0ZXJuOiAvXig2MDExfDY1fDY0WzQtOV18NjIyKS8sXG4gICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgIGx1aG46IHRydWVcbiAgICB9LCB7XG4gICAgICB0eXBlOiAnZWxvJyxcbiAgICAgIHBhdHRlcm46IC9eNDAxMTc4fF40MDExNzl8XjQzMTI3NHxeNDM4OTM1fF40NTE0MTZ8XjQ1NzM5M3xeNDU3NjMxfF40NTc2MzJ8XjUwNDE3NXxeNjI3NzgwfF42MzYyOTd8XjYzNjM2OXxeNjM2MzY4fF4oNTA2Njk5fDUwNjdbMC02XVxcZHw1MDY3N1swLThdKXxeKDUwOTAwXFxkfDUwOTBbMS05XVxcZHw1MDlbMS05XVxcZHsyfSl8XjY1MDAzWzEtM118Xig2NTAwM1s1LTldfDY1MDA0XFxkfDY1MDA1WzAtMV0pfF4oNjUwNDBbNS05XXw2NTA0WzEtM11cXGQpfF4oNjUwNDhbNS05XXw2NTA0OVxcZHw2NTA1WzAtMl1cXGR8NjUwNTNbMC04XSl8Xig2NTA1NFsxLTldfDY1MDVbNS04XVxcZHw2NTA1OVswLThdKXxeKDY1MDcwXFxkfDY1MDcxWzAtOF0pfF42NTA3MlswLTddfF4oNjUwOTBbMS05XXw2NTA5MVxcZHw2NTA5MjApfF4oNjUxNjVbMi05XXw2NTE2WzYtN11cXGQpfF4oNjU1MDBcXGR8NjU1MDFcXGQpfF4oNjU1MDJbMS05XXw2NTUwWzMtNF1cXGR8NjU1MDVbMC04XSl8Xig2NTA5MlsxLTldfDY1MDk3WzAtOF0pLyxcbiAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgbHVobjogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHR5cGU6ICdoaXBlcmNhcmQnLFxuICAgICAgcGF0dGVybjogL14oMzg0MTAwfDM4NDE0MHwzODQxNjB8NjA2MjgyfDYzNzA5NXw2Mzc1Njh8NjAoPyExMSkpLyxcbiAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgIGxlbmd0aDogWzE0LCAxNSwgMTYsIDE3LCAxOCwgMTldLFxuICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICBsdWhuOiB0cnVlXG4gICAgfSwge1xuICAgICAgdHlwZTogJ2pjYicsXG4gICAgICBwYXR0ZXJuOiAvXigzMDhbOC05XXwzMDlbMC0zXXwzMDk0WzBdezR9fDMwOVs2LTldfDMxMFswLTJdfDMxMVsyLTldfDMxMjB8MzE1WzgtOV18MzMzWzctOV18MzM0WzAtOV18MzUpLyxcbiAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgIGxlbmd0aDogWzE2LCAxOV0sXG4gICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgIGx1aG46IHRydWVcbiAgICB9LCB7XG4gICAgICB0eXBlOiAnbGFzZXInLFxuICAgICAgcGF0dGVybjogL14oNjcwNnw2NzcxfDY3MDkpLyxcbiAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgIGxlbmd0aDogWzE2LCAxNywgMTgsIDE5XSxcbiAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgbHVobjogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHR5cGU6ICdtYWVzdHJvJyxcbiAgICAgIHBhdHRlcm46IC9eKDUwfDVbNi05XXw2MDA3fDYyMjB8NjMwNHw2NzAzfDY3MDh8Njc1OXw2NzZbMS0zXSkvLFxuICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgbGVuZ3RoOiBbMTIsIDEzLCAxNCwgMTUsIDE2LCAxNywgMTgsIDE5XSxcbiAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgbHVobjogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHR5cGU6ICdtYXN0ZXJjYXJkJyxcbiAgICAgIHBhdHRlcm46IC9eKDVbMS01XXw2NzcxODkpfF4oMjIyWzEtOV18MlszLTZdXFxkezJ9fDI3WzAtMV1cXGR8MjcyMCkvLFxuICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICBsdWhuOiB0cnVlXG4gICAgfSwge1xuICAgICAgdHlwZTogJ21pcicsXG4gICAgICBwYXR0ZXJuOiAvXjIyMFswLTRdWzAtOV1bMC05XVxcZHsxMH0kLyxcbiAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgbHVobjogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHR5cGU6ICd0cm95JyxcbiAgICAgIHBhdHRlcm46IC9eOTc5Mi8sXG4gICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgIGx1aG46IHRydWVcbiAgICB9LCB7XG4gICAgICB0eXBlOiAndW5pb25wYXknLFxuICAgICAgcGF0dGVybjogL142Mi8sXG4gICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICBsZW5ndGg6IFsxNiwgMTcsIDE4LCAxOV0sXG4gICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgIGx1aG46IGZhbHNlXG4gICAgfSwge1xuICAgICAgdHlwZTogJ3Zpc2FlbGVjdHJvbicsXG4gICAgICBwYXR0ZXJuOiAvXjQoMDI2fDE3NTAwfDQwNXw1MDh8ODQ0fDkxWzM3XSkvLFxuICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICBsdWhuOiB0cnVlXG4gICAgfSwge1xuICAgICAgdHlwZTogJ3Zpc2EnLFxuICAgICAgcGF0dGVybjogL140LyxcbiAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgIGxlbmd0aDogWzEzLCAxNl0sXG4gICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgIGx1aG46IHRydWVcbiAgICB9XG4gIF07XG5cbiAgY2FyZEZyb21OdW1iZXIgPSBmdW5jdGlvbihudW0pIHtcbiAgICB2YXIgY2FyZCwgZm91bmRDYXJkLCBqLCBsZW4sIG1hdGNoO1xuICAgIG51bSA9IChudW0gKyAnJykucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICBmb3VuZENhcmQgPSB2b2lkIDA7XG4gICAgZm9yIChqID0gMCwgbGVuID0gY2FyZHMubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgIGNhcmQgPSBjYXJkc1tqXTtcbiAgICAgIGlmIChtYXRjaCA9IG51bS5tYXRjaChjYXJkLnBhdHRlcm4pKSB7XG4gICAgICAgIGlmICghZm91bmRDYXJkIHx8IG1hdGNoWzBdLmxlbmd0aCA+IGZvdW5kQ2FyZFsxXVswXS5sZW5ndGgpIHtcbiAgICAgICAgICBmb3VuZENhcmQgPSBbY2FyZCwgbWF0Y2hdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmb3VuZENhcmQgJiYgZm91bmRDYXJkWzBdO1xuICB9O1xuXG4gIGNhcmRGcm9tVHlwZSA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICB2YXIgY2FyZCwgaiwgbGVuO1xuICAgIGZvciAoaiA9IDAsIGxlbiA9IGNhcmRzLmxlbmd0aDsgaiA8IGxlbjsgaisrKSB7XG4gICAgICBjYXJkID0gY2FyZHNbal07XG4gICAgICBpZiAoY2FyZC50eXBlID09PSB0eXBlKSB7XG4gICAgICAgIHJldHVybiBjYXJkO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBsdWhuQ2hlY2sgPSBmdW5jdGlvbihudW0pIHtcbiAgICB2YXIgZGlnaXQsIGRpZ2l0cywgaiwgbGVuLCBvZGQsIHN1bTtcbiAgICBvZGQgPSB0cnVlO1xuICAgIHN1bSA9IDA7XG4gICAgZGlnaXRzID0gKG51bSArICcnKS5zcGxpdCgnJykucmV2ZXJzZSgpO1xuICAgIGZvciAoaiA9IDAsIGxlbiA9IGRpZ2l0cy5sZW5ndGg7IGogPCBsZW47IGorKykge1xuICAgICAgZGlnaXQgPSBkaWdpdHNbal07XG4gICAgICBkaWdpdCA9IHBhcnNlSW50KGRpZ2l0LCAxMCk7XG4gICAgICBpZiAoKG9kZCA9ICFvZGQpKSB7XG4gICAgICAgIGRpZ2l0ICo9IDI7XG4gICAgICB9XG4gICAgICBpZiAoZGlnaXQgPiA5KSB7XG4gICAgICAgIGRpZ2l0IC09IDk7XG4gICAgICB9XG4gICAgICBzdW0gKz0gZGlnaXQ7XG4gICAgfVxuICAgIHJldHVybiBzdW0gJSAxMCA9PT0gMDtcbiAgfTtcblxuICBoYXNUZXh0U2VsZWN0ZWQgPSBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICB2YXIgZSwgcmVmO1xuICAgIHRyeSB7XG4gICAgICBpZiAoKHRhcmdldC5zZWxlY3Rpb25TdGFydCAhPSBudWxsKSAmJiB0YXJnZXQuc2VsZWN0aW9uU3RhcnQgIT09IHRhcmdldC5zZWxlY3Rpb25FbmQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBkb2N1bWVudCAhPT0gbnVsbCA/IChyZWYgPSBkb2N1bWVudC5zZWxlY3Rpb24pICE9IG51bGwgPyByZWYuY3JlYXRlUmFuZ2UgOiB2b2lkIDAgOiB2b2lkIDApICE9IG51bGwpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpLnRleHQpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBlID0gZXJyb3I7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICByZUZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgcmV0dXJuIHNldFRpbWVvdXQoKGZ1bmN0aW9uKF90aGlzKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0YXJnZXQsIHZhbHVlO1xuICAgICAgICB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgdmFsdWUgPSBRSi52YWwodGFyZ2V0KTtcbiAgICAgICAgdmFsdWUgPSBQYXltZW50LmZucy5mb3JtYXRDYXJkTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgY3Vyc29yU2FmZUFzc2lnblZhbHVlKHRhcmdldCwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gUUoudHJpZ2dlcih0YXJnZXQsICdjaGFuZ2UnKTtcbiAgICAgIH07XG4gICAgfSkodGhpcykpO1xuICB9O1xuXG4gIGZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihtYXhMZW5ndGgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGNhcmQsIGRpZ2l0LCBpLCBqLCBsZW4sIGxlbmd0aCwgcmUsIHRhcmdldCwgdXBwZXJMZW5ndGgsIHVwcGVyTGVuZ3RocywgdmFsdWU7XG4gICAgICBpZiAoZS53aGljaCA+IDApIHtcbiAgICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgICB2YWx1ZSA9IFFKLnZhbChlLnRhcmdldCkgKyBkaWdpdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRpZ2l0ID0gZS5kYXRhO1xuICAgICAgICB2YWx1ZSA9IFFKLnZhbChlLnRhcmdldCk7XG4gICAgICB9XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKHZhbHVlKTtcbiAgICAgIGxlbmd0aCA9ICh2YWx1ZS5yZXBsYWNlKC9cXEQvZywgJycpKS5sZW5ndGg7XG4gICAgICB1cHBlckxlbmd0aHMgPSBbMTZdO1xuICAgICAgaWYgKGNhcmQpIHtcbiAgICAgICAgdXBwZXJMZW5ndGhzID0gY2FyZC5sZW5ndGg7XG4gICAgICB9XG4gICAgICBpZiAobWF4TGVuZ3RoKSB7XG4gICAgICAgIHVwcGVyTGVuZ3RocyA9IHVwcGVyTGVuZ3Rocy5maWx0ZXIoZnVuY3Rpb24oeCkge1xuICAgICAgICAgIHJldHVybiB4IDw9IG1heExlbmd0aDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBmb3IgKGkgPSBqID0gMCwgbGVuID0gdXBwZXJMZW5ndGhzLmxlbmd0aDsgaiA8IGxlbjsgaSA9ICsraikge1xuICAgICAgICB1cHBlckxlbmd0aCA9IHVwcGVyTGVuZ3Roc1tpXTtcbiAgICAgICAgaWYgKGxlbmd0aCA+PSB1cHBlckxlbmd0aCAmJiB1cHBlckxlbmd0aHNbaSArIDFdKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlbmd0aCA+PSB1cHBlckxlbmd0aCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGhhc1RleHRTZWxlY3RlZCh0YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJkICYmIGNhcmQudHlwZSA9PT0gJ2FtZXgnKSB7XG4gICAgICAgIHJlID0gL14oXFxkezR9fFxcZHs0fVxcc1xcZHs2fSkkLztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlID0gLyg/Ol58XFxzKShcXGR7NH0pJC87XG4gICAgICB9XG4gICAgICB2YWx1ZSA9IHZhbHVlLnN1YnN0cmluZygwLCB2YWx1ZS5sZW5ndGggLSAxKTtcbiAgICAgIGlmIChyZS50ZXN0KHZhbHVlKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIFFKLnZhbCh0YXJnZXQsIHZhbHVlICsgJyAnICsgZGlnaXQpO1xuICAgICAgICByZXR1cm4gUUoudHJpZ2dlcih0YXJnZXQsICdjaGFuZ2UnKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIGZvcm1hdEJhY2tDYXJkTnVtYmVyID0gZnVuY3Rpb24oZSkge1xuICAgIHZhciB0YXJnZXQsIHZhbHVlO1xuICAgIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIHZhbHVlID0gUUoudmFsKHRhcmdldCk7XG4gICAgaWYgKGUubWV0YSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZS53aGljaCAhPT0gOCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoaGFzVGV4dFNlbGVjdGVkKHRhcmdldCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKC9cXGRcXHMkLy50ZXN0KHZhbHVlKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgUUoudmFsKHRhcmdldCwgdmFsdWUucmVwbGFjZSgvXFxkXFxzJC8sICcnKSk7XG4gICAgICByZXR1cm4gUUoudHJpZ2dlcih0YXJnZXQsICdjaGFuZ2UnKTtcbiAgICB9IGVsc2UgaWYgKC9cXHNcXGQ/JC8udGVzdCh2YWx1ZSkpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIFFKLnZhbCh0YXJnZXQsIHZhbHVlLnJlcGxhY2UoL1xcc1xcZD8kLywgJycpKTtcbiAgICAgIHJldHVybiBRSi50cmlnZ2VyKHRhcmdldCwgJ2NoYW5nZScpO1xuICAgIH1cbiAgfTtcblxuICBmb3JtYXRFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgdmFyIGRpZ2l0LCB0YXJnZXQsIHZhbDtcbiAgICB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICBpZiAoZS53aGljaCA+IDApIHtcbiAgICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIHZhbCA9IFFKLnZhbCh0YXJnZXQpICsgZGlnaXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpZ2l0ID0gZS5kYXRhO1xuICAgICAgdmFsID0gUUoudmFsKHRhcmdldCk7XG4gICAgfVxuICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKC9eXFxkJC8udGVzdCh2YWwpICYmICh2YWwgIT09ICcwJyAmJiB2YWwgIT09ICcxJykpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIFFKLnZhbCh0YXJnZXQsIFwiMFwiICsgdmFsICsgXCIgLyBcIik7XG4gICAgICByZXR1cm4gUUoudHJpZ2dlcih0YXJnZXQsICdjaGFuZ2UnKTtcbiAgICB9IGVsc2UgaWYgKC9eXFxkXFxkJC8udGVzdCh2YWwpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBRSi52YWwodGFyZ2V0LCB2YWwgKyBcIiAvIFwiKTtcbiAgICAgIHJldHVybiBRSi50cmlnZ2VyKHRhcmdldCwgJ2NoYW5nZScpO1xuICAgIH1cbiAgfTtcblxuICBmb3JtYXRNb250aEV4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgZGlnaXQsIHRhcmdldCwgdmFsO1xuICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIHZhbCA9IFFKLnZhbCh0YXJnZXQpICsgZGlnaXQ7XG4gICAgaWYgKC9eXFxkJC8udGVzdCh2YWwpICYmICh2YWwgIT09ICcwJyAmJiB2YWwgIT09ICcxJykpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIFFKLnZhbCh0YXJnZXQsIFwiMFwiICsgdmFsKTtcbiAgICAgIHJldHVybiBRSi50cmlnZ2VyKHRhcmdldCwgJ2NoYW5nZScpO1xuICAgIH0gZWxzZSBpZiAoL15cXGRcXGQkLy50ZXN0KHZhbCkpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIFFKLnZhbCh0YXJnZXQsIFwiXCIgKyB2YWwpO1xuICAgICAgcmV0dXJuIFFKLnRyaWdnZXIodGFyZ2V0LCAnY2hhbmdlJyk7XG4gICAgfVxuICB9O1xuXG4gIGZvcm1hdEZvcndhcmRFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgdmFyIGRpZ2l0LCB0YXJnZXQsIHZhbDtcbiAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICB2YWwgPSBRSi52YWwodGFyZ2V0KTtcbiAgICBpZiAoL15cXGRcXGQkLy50ZXN0KHZhbCkpIHtcbiAgICAgIFFKLnZhbCh0YXJnZXQsIHZhbCArIFwiIC8gXCIpO1xuICAgICAgcmV0dXJuIFFKLnRyaWdnZXIodGFyZ2V0LCAnY2hhbmdlJyk7XG4gICAgfVxuICB9O1xuXG4gIGZvcm1hdEZvcndhcmRTbGFzaCA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgc2xhc2gsIHRhcmdldCwgdmFsO1xuICAgIHNsYXNoID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICBpZiAoc2xhc2ggIT09ICcvJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICB2YWwgPSBRSi52YWwodGFyZ2V0KTtcbiAgICBpZiAoL15cXGQkLy50ZXN0KHZhbCkgJiYgdmFsICE9PSAnMCcpIHtcbiAgICAgIFFKLnZhbCh0YXJnZXQsIFwiMFwiICsgdmFsICsgXCIgLyBcIik7XG4gICAgICByZXR1cm4gUUoudHJpZ2dlcih0YXJnZXQsICdjaGFuZ2UnKTtcbiAgICB9XG4gIH07XG5cbiAgZm9ybWF0QmFja0V4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgdGFyZ2V0LCB2YWx1ZTtcbiAgICBpZiAoZS5tZXRhS2V5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIHZhbHVlID0gUUoudmFsKHRhcmdldCk7XG4gICAgaWYgKGUud2hpY2ggIT09IDgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGhhc1RleHRTZWxlY3RlZCh0YXJnZXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICgvXFxkKFxcc3xcXC8pKyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBRSi52YWwodGFyZ2V0LCB2YWx1ZS5yZXBsYWNlKC9cXGQoXFxzfFxcLykqJC8sICcnKSk7XG4gICAgICByZXR1cm4gUUoudHJpZ2dlcih0YXJnZXQsICdjaGFuZ2UnKTtcbiAgICB9IGVsc2UgaWYgKC9cXHNcXC9cXHM/XFxkPyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBRSi52YWwodGFyZ2V0LCB2YWx1ZS5yZXBsYWNlKC9cXHNcXC9cXHM/XFxkPyQvLCAnJykpO1xuICAgICAgcmV0dXJuIFFKLnRyaWdnZXIodGFyZ2V0LCAnY2hhbmdlJyk7XG4gICAgfVxuICB9O1xuXG4gIHJlc3RyaWN0TnVtZXJpYyA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgaW5wdXQ7XG4gICAgaWYgKGUubWV0YUtleSB8fCBlLmN0cmxLZXkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAoZS53aGljaCA9PT0gMzIpIHtcbiAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIGlmIChlLndoaWNoID09PSAwKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGUud2hpY2ggPCAzMykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlucHV0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICBpZiAoIS9bXFxkXFxzXS8udGVzdChpbnB1dCkpIHtcbiAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9O1xuXG4gIHJlc3RyaWN0Q2FyZE51bWJlciA9IGZ1bmN0aW9uKG1heExlbmd0aCkge1xuICAgIHJldHVybiBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY2FyZCwgZGlnaXQsIGxlbmd0aCwgdGFyZ2V0LCB2YWx1ZTtcbiAgICAgIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoaGFzVGV4dFNlbGVjdGVkKHRhcmdldCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFsdWUgPSAoUUoudmFsKHRhcmdldCkgKyBkaWdpdCkucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcih2YWx1ZSk7XG4gICAgICBsZW5ndGggPSAxNjtcbiAgICAgIGlmIChjYXJkKSB7XG4gICAgICAgIGxlbmd0aCA9IGNhcmQubGVuZ3RoW2NhcmQubGVuZ3RoLmxlbmd0aCAtIDFdO1xuICAgICAgfVxuICAgICAgaWYgKG1heExlbmd0aCkge1xuICAgICAgICBsZW5ndGggPSBNYXRoLm1pbihsZW5ndGgsIG1heExlbmd0aCk7XG4gICAgICB9XG4gICAgICBpZiAoISh2YWx1ZS5sZW5ndGggPD0gbGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgcmVzdHJpY3RFeHBpcnkgPSBmdW5jdGlvbihlLCBsZW5ndGgpIHtcbiAgICB2YXIgZGlnaXQsIHRhcmdldCwgdmFsdWU7XG4gICAgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGhhc1RleHRTZWxlY3RlZCh0YXJnZXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhbHVlID0gUUoudmFsKHRhcmdldCkgKyBkaWdpdDtcbiAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xcRC9nLCAnJyk7XG4gICAgaWYgKHZhbHVlLmxlbmd0aCA+IGxlbmd0aCkge1xuICAgICAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH07XG5cbiAgcmVzdHJpY3RDb21iaW5lZEV4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICByZXR1cm4gcmVzdHJpY3RFeHBpcnkoZSwgNik7XG4gIH07XG5cbiAgcmVzdHJpY3RNb250aEV4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICByZXR1cm4gcmVzdHJpY3RFeHBpcnkoZSwgMik7XG4gIH07XG5cbiAgcmVzdHJpY3RZZWFyRXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgIHJldHVybiByZXN0cmljdEV4cGlyeShlLCA0KTtcbiAgfTtcblxuICByZXN0cmljdENWQyA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgZGlnaXQsIHRhcmdldCwgdmFsO1xuICAgIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChoYXNUZXh0U2VsZWN0ZWQodGFyZ2V0KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YWwgPSBRSi52YWwodGFyZ2V0KSArIGRpZ2l0O1xuICAgIGlmICghKHZhbC5sZW5ndGggPD0gNCkpIHtcbiAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9O1xuXG4gIHNldENhcmRUeXBlID0gZnVuY3Rpb24oZSkge1xuICAgIHZhciBhbGxUeXBlcywgY2FyZCwgY2FyZFR5cGUsIHRhcmdldCwgdmFsO1xuICAgIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIHZhbCA9IFFKLnZhbCh0YXJnZXQpO1xuICAgIGNhcmRUeXBlID0gUGF5bWVudC5mbnMuY2FyZFR5cGUodmFsKSB8fCAndW5rbm93bic7XG4gICAgaWYgKCFRSi5oYXNDbGFzcyh0YXJnZXQsIGNhcmRUeXBlKSkge1xuICAgICAgYWxsVHlwZXMgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBqLCBsZW4sIHJlc3VsdHM7XG4gICAgICAgIHJlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yIChqID0gMCwgbGVuID0gY2FyZHMubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICBjYXJkID0gY2FyZHNbal07XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKGNhcmQudHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICB9KSgpO1xuICAgICAgUUoucmVtb3ZlQ2xhc3ModGFyZ2V0LCAndW5rbm93bicpO1xuICAgICAgUUoucmVtb3ZlQ2xhc3ModGFyZ2V0LCBhbGxUeXBlcy5qb2luKCcgJykpO1xuICAgICAgUUouYWRkQ2xhc3ModGFyZ2V0LCBjYXJkVHlwZSk7XG4gICAgICBRSi50b2dnbGVDbGFzcyh0YXJnZXQsICdpZGVudGlmaWVkJywgY2FyZFR5cGUgIT09ICd1bmtub3duJyk7XG4gICAgICByZXR1cm4gUUoudHJpZ2dlcih0YXJnZXQsICdwYXltZW50LmNhcmRUeXBlJywgY2FyZFR5cGUpO1xuICAgIH1cbiAgfTtcblxuICBjdXJzb3JTYWZlQXNzaWduVmFsdWUgPSBmdW5jdGlvbih0YXJnZXQsIHZhbHVlKSB7XG4gICAgdmFyIHNlbGVjdGlvbkVuZDtcbiAgICBzZWxlY3Rpb25FbmQgPSB0YXJnZXQuc2VsZWN0aW9uRW5kO1xuICAgIFFKLnZhbCh0YXJnZXQsIHZhbHVlKTtcbiAgICBpZiAoc2VsZWN0aW9uRW5kKSB7XG4gICAgICByZXR1cm4gdGFyZ2V0LnNlbGVjdGlvbkVuZCA9IHNlbGVjdGlvbkVuZDtcbiAgICB9XG4gIH07XG5cbiAgUGF5bWVudCA9IChmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBQYXltZW50KCkge31cblxuICAgIFBheW1lbnQuSiA9IFFKO1xuXG4gICAgUGF5bWVudC5mbnMgPSB7XG4gICAgICBjYXJkRXhwaXJ5VmFsOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB2YXIgbW9udGgsIHByZWZpeCwgcmVmLCB5ZWFyO1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xccy9nLCAnJyk7XG4gICAgICAgIHJlZiA9IHZhbHVlLnNwbGl0KCcvJywgMiksIG1vbnRoID0gcmVmWzBdLCB5ZWFyID0gcmVmWzFdO1xuICAgICAgICBpZiAoKHllYXIgIT0gbnVsbCA/IHllYXIubGVuZ3RoIDogdm9pZCAwKSA9PT0gMiAmJiAvXlxcZCskLy50ZXN0KHllYXIpKSB7XG4gICAgICAgICAgcHJlZml4ID0gKG5ldyBEYXRlKS5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgIHByZWZpeCA9IHByZWZpeC50b1N0cmluZygpLnNsaWNlKDAsIDIpO1xuICAgICAgICAgIHllYXIgPSBwcmVmaXggKyB5ZWFyO1xuICAgICAgICB9XG4gICAgICAgIG1vbnRoID0gcGFyc2VJbnQobW9udGgsIDEwKTtcbiAgICAgICAgeWVhciA9IHBhcnNlSW50KHllYXIsIDEwKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBtb250aDogbW9udGgsXG4gICAgICAgICAgeWVhcjogeWVhclxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHZhbGlkYXRlQ2FyZE51bWJlcjogZnVuY3Rpb24obnVtKSB7XG4gICAgICAgIHZhciBjYXJkLCByZWY7XG4gICAgICAgIG51bSA9IChudW0gKyAnJykucmVwbGFjZSgvXFxzK3wtL2csICcnKTtcbiAgICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KG51bSkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKG51bSk7XG4gICAgICAgIGlmICghY2FyZCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHJlZiA9IG51bS5sZW5ndGgsIGluZGV4T2YuY2FsbChjYXJkLmxlbmd0aCwgcmVmKSA+PSAwKSAmJiAoY2FyZC5sdWhuID09PSBmYWxzZSB8fCBsdWhuQ2hlY2sobnVtKSk7XG4gICAgICB9LFxuICAgICAgdmFsaWRhdGVDYXJkRXhwaXJ5OiBmdW5jdGlvbihtb250aCwgeWVhcikge1xuICAgICAgICB2YXIgY3VycmVudFRpbWUsIGV4cGlyeSwgcHJlZml4LCByZWYsIHJlZjE7XG4gICAgICAgIGlmICh0eXBlb2YgbW9udGggPT09ICdvYmplY3QnICYmICdtb250aCcgaW4gbW9udGgpIHtcbiAgICAgICAgICByZWYgPSBtb250aCwgbW9udGggPSByZWYubW9udGgsIHllYXIgPSByZWYueWVhcjtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbW9udGggPT09ICdzdHJpbmcnICYmIGluZGV4T2YuY2FsbChtb250aCwgJy8nKSA+PSAwKSB7XG4gICAgICAgICAgcmVmMSA9IFBheW1lbnQuZm5zLmNhcmRFeHBpcnlWYWwobW9udGgpLCBtb250aCA9IHJlZjEubW9udGgsIHllYXIgPSByZWYxLnllYXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEobW9udGggJiYgeWVhcikpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbW9udGggPSBRSi50cmltKG1vbnRoKTtcbiAgICAgICAgeWVhciA9IFFKLnRyaW0oeWVhcik7XG4gICAgICAgIGlmICghL15cXGQrJC8udGVzdChtb250aCkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KHllYXIpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIG1vbnRoID0gcGFyc2VJbnQobW9udGgsIDEwKTtcbiAgICAgICAgaWYgKCEobW9udGggJiYgbW9udGggPD0gMTIpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh5ZWFyLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIHByZWZpeCA9IChuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICBwcmVmaXggPSBwcmVmaXgudG9TdHJpbmcoKS5zbGljZSgwLCAyKTtcbiAgICAgICAgICB5ZWFyID0gcHJlZml4ICsgeWVhcjtcbiAgICAgICAgfVxuICAgICAgICBleHBpcnkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCk7XG4gICAgICAgIGN1cnJlbnRUaW1lID0gbmV3IERhdGU7XG4gICAgICAgIGV4cGlyeS5zZXRNb250aChleHBpcnkuZ2V0TW9udGgoKSAtIDEpO1xuICAgICAgICBleHBpcnkuc2V0TW9udGgoZXhwaXJ5LmdldE1vbnRoKCkgKyAxLCAxKTtcbiAgICAgICAgcmV0dXJuIGV4cGlyeSA+IGN1cnJlbnRUaW1lO1xuICAgICAgfSxcbiAgICAgIHZhbGlkYXRlQ2FyZENWQzogZnVuY3Rpb24oY3ZjLCB0eXBlKSB7XG4gICAgICAgIHZhciByZWYsIHJlZjE7XG4gICAgICAgIGN2YyA9IFFKLnRyaW0oY3ZjKTtcbiAgICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGN2YykpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgJiYgY2FyZEZyb21UeXBlKHR5cGUpKSB7XG4gICAgICAgICAgcmV0dXJuIHJlZiA9IGN2Yy5sZW5ndGgsIGluZGV4T2YuY2FsbCgocmVmMSA9IGNhcmRGcm9tVHlwZSh0eXBlKSkgIT0gbnVsbCA/IHJlZjEuY3ZjTGVuZ3RoIDogdm9pZCAwLCByZWYpID49IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGN2Yy5sZW5ndGggPj0gMyAmJiBjdmMubGVuZ3RoIDw9IDQ7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjYXJkVHlwZTogZnVuY3Rpb24obnVtKSB7XG4gICAgICAgIHZhciByZWY7XG4gICAgICAgIGlmICghbnVtKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICgocmVmID0gY2FyZEZyb21OdW1iZXIobnVtKSkgIT0gbnVsbCA/IHJlZi50eXBlIDogdm9pZCAwKSB8fCBudWxsO1xuICAgICAgfSxcbiAgICAgIGZvcm1hdENhcmROdW1iZXI6IGZ1bmN0aW9uKG51bSkge1xuICAgICAgICB2YXIgY2FyZCwgZ3JvdXBzLCByZWYsIHVwcGVyTGVuZ3RoO1xuICAgICAgICBjYXJkID0gY2FyZEZyb21OdW1iZXIobnVtKTtcbiAgICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgICAgcmV0dXJuIG51bTtcbiAgICAgICAgfVxuICAgICAgICB1cHBlckxlbmd0aCA9IGNhcmQubGVuZ3RoW2NhcmQubGVuZ3RoLmxlbmd0aCAtIDFdO1xuICAgICAgICBudW0gPSBudW0ucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgICAgbnVtID0gbnVtLnNsaWNlKDAsIHVwcGVyTGVuZ3RoKTtcbiAgICAgICAgaWYgKGNhcmQuZm9ybWF0Lmdsb2JhbCkge1xuICAgICAgICAgIHJldHVybiAocmVmID0gbnVtLm1hdGNoKGNhcmQuZm9ybWF0KSkgIT0gbnVsbCA/IHJlZi5qb2luKCcgJykgOiB2b2lkIDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ3JvdXBzID0gY2FyZC5mb3JtYXQuZXhlYyhudW0pO1xuICAgICAgICAgIGlmIChncm91cHMgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBncm91cHMuc2hpZnQoKTtcbiAgICAgICAgICBncm91cHMgPSBncm91cHMuZmlsdGVyKGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgIHJldHVybiBuO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBncm91cHMuam9pbignICcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIFBheW1lbnQucmVzdHJpY3ROdW1lcmljID0gZnVuY3Rpb24oZWwpIHtcbiAgICAgIFFKLm9uKGVsLCAna2V5cHJlc3MnLCByZXN0cmljdE51bWVyaWMpO1xuICAgICAgcmV0dXJuIFFKLm9uKGVsLCAnaW5wdXQnLCByZXN0cmljdE51bWVyaWMpO1xuICAgIH07XG5cbiAgICBQYXltZW50LmNhcmRFeHBpcnlWYWwgPSBmdW5jdGlvbihlbCkge1xuICAgICAgcmV0dXJuIFBheW1lbnQuZm5zLmNhcmRFeHBpcnlWYWwoUUoudmFsKGVsKSk7XG4gICAgfTtcblxuICAgIFBheW1lbnQuZm9ybWF0Q2FyZENWQyA9IGZ1bmN0aW9uKGVsKSB7XG4gICAgICBQYXltZW50LnJlc3RyaWN0TnVtZXJpYyhlbCk7XG4gICAgICBRSi5vbihlbCwgJ2tleXByZXNzJywgcmVzdHJpY3RDVkMpO1xuICAgICAgUUoub24oZWwsICdpbnB1dCcsIHJlc3RyaWN0Q1ZDKTtcbiAgICAgIHJldHVybiBlbDtcbiAgICB9O1xuXG4gICAgUGF5bWVudC5mb3JtYXRDYXJkRXhwaXJ5ID0gZnVuY3Rpb24oZWwpIHtcbiAgICAgIHZhciBtb250aCwgeWVhcjtcbiAgICAgIFBheW1lbnQucmVzdHJpY3ROdW1lcmljKGVsKTtcbiAgICAgIGlmIChlbC5sZW5ndGggJiYgZWwubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIG1vbnRoID0gZWxbMF0sIHllYXIgPSBlbFsxXTtcbiAgICAgICAgdGhpcy5mb3JtYXRDYXJkRXhwaXJ5TXVsdGlwbGUobW9udGgsIHllYXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUUoub24oZWwsICdrZXlwcmVzcycsIHJlc3RyaWN0Q29tYmluZWRFeHBpcnkpO1xuICAgICAgICBRSi5vbihlbCwgJ2tleXByZXNzJywgZm9ybWF0RXhwaXJ5KTtcbiAgICAgICAgUUoub24oZWwsICdrZXlwcmVzcycsIGZvcm1hdEZvcndhcmRTbGFzaCk7XG4gICAgICAgIFFKLm9uKGVsLCAna2V5cHJlc3MnLCBmb3JtYXRGb3J3YXJkRXhwaXJ5KTtcbiAgICAgICAgUUoub24oZWwsICdrZXlkb3duJywgZm9ybWF0QmFja0V4cGlyeSk7XG4gICAgICAgIFFKLm9uKGVsLCAnaW5wdXQnLCBmb3JtYXRFeHBpcnkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVsO1xuICAgIH07XG5cbiAgICBQYXltZW50LmZvcm1hdENhcmRFeHBpcnlNdWx0aXBsZSA9IGZ1bmN0aW9uKG1vbnRoLCB5ZWFyKSB7XG4gICAgICBRSi5vbihtb250aCwgJ2tleXByZXNzJywgcmVzdHJpY3RNb250aEV4cGlyeSk7XG4gICAgICBRSi5vbihtb250aCwgJ2tleXByZXNzJywgZm9ybWF0TW9udGhFeHBpcnkpO1xuICAgICAgUUoub24obW9udGgsICdpbnB1dCcsIGZvcm1hdE1vbnRoRXhwaXJ5KTtcbiAgICAgIFFKLm9uKHllYXIsICdrZXlwcmVzcycsIHJlc3RyaWN0WWVhckV4cGlyeSk7XG4gICAgICByZXR1cm4gUUoub24oeWVhciwgJ2lucHV0JywgcmVzdHJpY3RZZWFyRXhwaXJ5KTtcbiAgICB9O1xuXG4gICAgUGF5bWVudC5mb3JtYXRDYXJkTnVtYmVyID0gZnVuY3Rpb24oZWwsIG1heExlbmd0aCkge1xuICAgICAgUGF5bWVudC5yZXN0cmljdE51bWVyaWMoZWwpO1xuICAgICAgUUoub24oZWwsICdrZXlwcmVzcycsIHJlc3RyaWN0Q2FyZE51bWJlcihtYXhMZW5ndGgpKTtcbiAgICAgIFFKLm9uKGVsLCAna2V5cHJlc3MnLCBmb3JtYXRDYXJkTnVtYmVyKG1heExlbmd0aCkpO1xuICAgICAgUUoub24oZWwsICdrZXlkb3duJywgZm9ybWF0QmFja0NhcmROdW1iZXIpO1xuICAgICAgUUoub24oZWwsICdrZXl1cCBibHVyJywgc2V0Q2FyZFR5cGUpO1xuICAgICAgUUoub24oZWwsICdibHVyJywgZm9ybWF0Q2FyZE51bWJlcihtYXhMZW5ndGgpKTtcbiAgICAgIFFKLm9uKGVsLCAncGFzdGUnLCByZUZvcm1hdENhcmROdW1iZXIpO1xuICAgICAgUUoub24oZWwsICdpbnB1dCcsIGZvcm1hdENhcmROdW1iZXIobWF4TGVuZ3RoKSk7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfTtcblxuICAgIFBheW1lbnQuZ2V0Q2FyZEFycmF5ID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gY2FyZHM7XG4gICAgfTtcblxuICAgIFBheW1lbnQuc2V0Q2FyZEFycmF5ID0gZnVuY3Rpb24oY2FyZEFycmF5KSB7XG4gICAgICBjYXJkcyA9IGNhcmRBcnJheTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICBQYXltZW50LmFkZFRvQ2FyZEFycmF5ID0gZnVuY3Rpb24oY2FyZE9iamVjdCkge1xuICAgICAgcmV0dXJuIGNhcmRzLnB1c2goY2FyZE9iamVjdCk7XG4gICAgfTtcblxuICAgIFBheW1lbnQucmVtb3ZlRnJvbUNhcmRBcnJheSA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgIHZhciBrZXksIHZhbHVlO1xuICAgICAgZm9yIChrZXkgaW4gY2FyZHMpIHtcbiAgICAgICAgdmFsdWUgPSBjYXJkc1trZXldO1xuICAgICAgICBpZiAodmFsdWUudHlwZSA9PT0gdHlwZSkge1xuICAgICAgICAgIGNhcmRzLnNwbGljZShrZXksIDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFBheW1lbnQ7XG5cbiAgfSkoKTtcblxuICBtb2R1bGUuZXhwb3J0cyA9IFBheW1lbnQ7XG5cbiAgZ2xvYmFsVGhpcy5QYXltZW50ID0gUGF5bWVudDtcblxufSkuY2FsbCh0aGlzKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../../../../node_modules/payment/lib/index.js\n");

/***/ }),

/***/ "../../../../node_modules/qj/lib/index.js":
/*!************************************************!*\
  !*** ../../../../node_modules/qj/lib/index.js ***!
  \************************************************/
/***/ (function(module) {

eval("// Generated by CoffeeScript 1.10.0\n(function() {\n  var QJ, rreturn, rtrim;\n\n  QJ = function(selector) {\n    if (QJ.isDOMElement(selector)) {\n      return selector;\n    }\n    return document.querySelectorAll(selector);\n  };\n\n  QJ.isDOMElement = function(el) {\n    return el && (el.nodeName != null);\n  };\n\n  rtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n\n  QJ.trim = function(text) {\n    if (text === null) {\n      return \"\";\n    } else {\n      return (text + \"\").replace(rtrim, \"\");\n    }\n  };\n\n  rreturn = /\\r/g;\n\n  QJ.val = function(el, val) {\n    var ret;\n    if (arguments.length > 1) {\n      return el.value = val;\n    } else {\n      ret = el.value;\n      if (typeof ret === \"string\") {\n        return ret.replace(rreturn, \"\");\n      } else {\n        if (ret === null) {\n          return \"\";\n        } else {\n          return ret;\n        }\n      }\n    }\n  };\n\n  QJ.preventDefault = function(eventObject) {\n    if (typeof eventObject.preventDefault === \"function\") {\n      eventObject.preventDefault();\n      return;\n    }\n    eventObject.returnValue = false;\n    return false;\n  };\n\n  QJ.normalizeEvent = function(e) {\n    var original;\n    original = e;\n    e = {\n      which: original.which != null ? original.which : void 0,\n      target: original.target || original.srcElement,\n      preventDefault: function() {\n        return QJ.preventDefault(original);\n      },\n      originalEvent: original,\n      data: original.data || original.detail\n    };\n    if (e.which == null) {\n      e.which = original.charCode != null ? original.charCode : original.keyCode;\n    }\n    return e;\n  };\n\n  QJ.on = function(element, eventName, callback) {\n    var el, i, j, len, len1, multEventName, originalCallback, ref;\n    if (element.length) {\n      for (i = 0, len = element.length; i < len; i++) {\n        el = element[i];\n        QJ.on(el, eventName, callback);\n      }\n      return;\n    }\n    if (eventName.match(\" \")) {\n      ref = eventName.split(\" \");\n      for (j = 0, len1 = ref.length; j < len1; j++) {\n        multEventName = ref[j];\n        QJ.on(element, multEventName, callback);\n      }\n      return;\n    }\n    originalCallback = callback;\n    callback = function(e) {\n      e = QJ.normalizeEvent(e);\n      return originalCallback(e);\n    };\n    if (element.addEventListener) {\n      return element.addEventListener(eventName, callback, false);\n    }\n    if (element.attachEvent) {\n      eventName = \"on\" + eventName;\n      return element.attachEvent(eventName, callback);\n    }\n    element['on' + eventName] = callback;\n  };\n\n  QJ.addClass = function(el, className) {\n    var e;\n    if (el.length) {\n      return (function() {\n        var i, len, results;\n        results = [];\n        for (i = 0, len = el.length; i < len; i++) {\n          e = el[i];\n          results.push(QJ.addClass(e, className));\n        }\n        return results;\n      })();\n    }\n    if (el.classList) {\n      return el.classList.add(className);\n    } else {\n      return el.className += ' ' + className;\n    }\n  };\n\n  QJ.hasClass = function(el, className) {\n    var e, hasClass, i, len;\n    if (el.length) {\n      hasClass = true;\n      for (i = 0, len = el.length; i < len; i++) {\n        e = el[i];\n        hasClass = hasClass && QJ.hasClass(e, className);\n      }\n      return hasClass;\n    }\n    if (el.classList) {\n      return el.classList.contains(className);\n    } else {\n      return new RegExp('(^| )' + className + '( |$)', 'gi').test(el.className);\n    }\n  };\n\n  QJ.removeClass = function(el, className) {\n    var cls, e, i, len, ref, results;\n    if (el.length) {\n      return (function() {\n        var i, len, results;\n        results = [];\n        for (i = 0, len = el.length; i < len; i++) {\n          e = el[i];\n          results.push(QJ.removeClass(e, className));\n        }\n        return results;\n      })();\n    }\n    if (el.classList) {\n      ref = className.split(' ');\n      results = [];\n      for (i = 0, len = ref.length; i < len; i++) {\n        cls = ref[i];\n        results.push(el.classList.remove(cls));\n      }\n      return results;\n    } else {\n      return el.className = el.className.replace(new RegExp('(^|\\\\b)' + className.split(' ').join('|') + '(\\\\b|$)', 'gi'), ' ');\n    }\n  };\n\n  QJ.toggleClass = function(el, className, bool) {\n    var e;\n    if (el.length) {\n      return (function() {\n        var i, len, results;\n        results = [];\n        for (i = 0, len = el.length; i < len; i++) {\n          e = el[i];\n          results.push(QJ.toggleClass(e, className, bool));\n        }\n        return results;\n      })();\n    }\n    if (bool) {\n      if (!QJ.hasClass(el, className)) {\n        return QJ.addClass(el, className);\n      }\n    } else {\n      return QJ.removeClass(el, className);\n    }\n  };\n\n  QJ.append = function(el, toAppend) {\n    var e;\n    if (el.length) {\n      return (function() {\n        var i, len, results;\n        results = [];\n        for (i = 0, len = el.length; i < len; i++) {\n          e = el[i];\n          results.push(QJ.append(e, toAppend));\n        }\n        return results;\n      })();\n    }\n    return el.insertAdjacentHTML('beforeend', toAppend);\n  };\n\n  QJ.find = function(el, selector) {\n    if (el instanceof NodeList || el instanceof Array) {\n      el = el[0];\n    }\n    return el.querySelectorAll(selector);\n  };\n\n  QJ.trigger = function(el, name, data) {\n    var e, error, ev;\n    try {\n      ev = new CustomEvent(name, {\n        detail: data\n      });\n    } catch (error) {\n      e = error;\n      ev = document.createEvent('CustomEvent');\n      if (ev.initCustomEvent) {\n        ev.initCustomEvent(name, true, true, data);\n      } else {\n        ev.initEvent(name, true, true, data);\n      }\n    }\n    return el.dispatchEvent(ev);\n  };\n\n  module.exports = QJ;\n\n}).call(this);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3FqL2xpYi9pbmRleC5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLFNBQVM7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsVUFBVTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsU0FBUztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLFNBQVM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxTQUFTO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFNBQVM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxTQUFTO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxTQUFTO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9xai9saWIvaW5kZXguanM/ZGM0YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuMTAuMFxuKGZ1bmN0aW9uKCkge1xuICB2YXIgUUosIHJyZXR1cm4sIHJ0cmltO1xuXG4gIFFKID0gZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICBpZiAoUUouaXNET01FbGVtZW50KHNlbGVjdG9yKSkge1xuICAgICAgcmV0dXJuIHNlbGVjdG9yO1xuICAgIH1cbiAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gIH07XG5cbiAgUUouaXNET01FbGVtZW50ID0gZnVuY3Rpb24oZWwpIHtcbiAgICByZXR1cm4gZWwgJiYgKGVsLm5vZGVOYW1lICE9IG51bGwpO1xuICB9O1xuXG4gIHJ0cmltID0gL15bXFxzXFx1RkVGRlxceEEwXSt8W1xcc1xcdUZFRkZcXHhBMF0rJC9nO1xuXG4gIFFKLnRyaW0gPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgaWYgKHRleHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gKHRleHQgKyBcIlwiKS5yZXBsYWNlKHJ0cmltLCBcIlwiKTtcbiAgICB9XG4gIH07XG5cbiAgcnJldHVybiA9IC9cXHIvZztcblxuICBRSi52YWwgPSBmdW5jdGlvbihlbCwgdmFsKSB7XG4gICAgdmFyIHJldDtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgIHJldHVybiBlbC52YWx1ZSA9IHZhbDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0ID0gZWwudmFsdWU7XG4gICAgICBpZiAodHlwZW9mIHJldCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gcmV0LnJlcGxhY2UocnJldHVybiwgXCJcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAocmV0ID09PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBRSi5wcmV2ZW50RGVmYXVsdCA9IGZ1bmN0aW9uKGV2ZW50T2JqZWN0KSB7XG4gICAgaWYgKHR5cGVvZiBldmVudE9iamVjdC5wcmV2ZW50RGVmYXVsdCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBldmVudE9iamVjdC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBldmVudE9iamVjdC5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBRSi5ub3JtYWxpemVFdmVudCA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgb3JpZ2luYWw7XG4gICAgb3JpZ2luYWwgPSBlO1xuICAgIGUgPSB7XG4gICAgICB3aGljaDogb3JpZ2luYWwud2hpY2ggIT0gbnVsbCA/IG9yaWdpbmFsLndoaWNoIDogdm9pZCAwLFxuICAgICAgdGFyZ2V0OiBvcmlnaW5hbC50YXJnZXQgfHwgb3JpZ2luYWwuc3JjRWxlbWVudCxcbiAgICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFFKLnByZXZlbnREZWZhdWx0KG9yaWdpbmFsKTtcbiAgICAgIH0sXG4gICAgICBvcmlnaW5hbEV2ZW50OiBvcmlnaW5hbCxcbiAgICAgIGRhdGE6IG9yaWdpbmFsLmRhdGEgfHwgb3JpZ2luYWwuZGV0YWlsXG4gICAgfTtcbiAgICBpZiAoZS53aGljaCA9PSBudWxsKSB7XG4gICAgICBlLndoaWNoID0gb3JpZ2luYWwuY2hhckNvZGUgIT0gbnVsbCA/IG9yaWdpbmFsLmNoYXJDb2RlIDogb3JpZ2luYWwua2V5Q29kZTtcbiAgICB9XG4gICAgcmV0dXJuIGU7XG4gIH07XG5cbiAgUUoub24gPSBmdW5jdGlvbihlbGVtZW50LCBldmVudE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGVsLCBpLCBqLCBsZW4sIGxlbjEsIG11bHRFdmVudE5hbWUsIG9yaWdpbmFsQ2FsbGJhY2ssIHJlZjtcbiAgICBpZiAoZWxlbWVudC5sZW5ndGgpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGVsZW1lbnQubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZWwgPSBlbGVtZW50W2ldO1xuICAgICAgICBRSi5vbihlbCwgZXZlbnROYW1lLCBjYWxsYmFjayk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChldmVudE5hbWUubWF0Y2goXCIgXCIpKSB7XG4gICAgICByZWYgPSBldmVudE5hbWUuc3BsaXQoXCIgXCIpO1xuICAgICAgZm9yIChqID0gMCwgbGVuMSA9IHJlZi5sZW5ndGg7IGogPCBsZW4xOyBqKyspIHtcbiAgICAgICAgbXVsdEV2ZW50TmFtZSA9IHJlZltqXTtcbiAgICAgICAgUUoub24oZWxlbWVudCwgbXVsdEV2ZW50TmFtZSwgY2FsbGJhY2spO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBvcmlnaW5hbENhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgY2FsbGJhY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgICBlID0gUUoubm9ybWFsaXplRXZlbnQoZSk7XG4gICAgICByZXR1cm4gb3JpZ2luYWxDYWxsYmFjayhlKTtcbiAgICB9O1xuICAgIGlmIChlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgIHJldHVybiBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBjYWxsYmFjaywgZmFsc2UpO1xuICAgIH1cbiAgICBpZiAoZWxlbWVudC5hdHRhY2hFdmVudCkge1xuICAgICAgZXZlbnROYW1lID0gXCJvblwiICsgZXZlbnROYW1lO1xuICAgICAgcmV0dXJuIGVsZW1lbnQuYXR0YWNoRXZlbnQoZXZlbnROYW1lLCBjYWxsYmFjayk7XG4gICAgfVxuICAgIGVsZW1lbnRbJ29uJyArIGV2ZW50TmFtZV0gPSBjYWxsYmFjaztcbiAgfTtcblxuICBRSi5hZGRDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjbGFzc05hbWUpIHtcbiAgICB2YXIgZTtcbiAgICBpZiAoZWwubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaSwgbGVuLCByZXN1bHRzO1xuICAgICAgICByZXN1bHRzID0gW107XG4gICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGVsLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgZSA9IGVsW2ldO1xuICAgICAgICAgIHJlc3VsdHMucHVzaChRSi5hZGRDbGFzcyhlLCBjbGFzc05hbWUpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgIH0pKCk7XG4gICAgfVxuICAgIGlmIChlbC5jbGFzc0xpc3QpIHtcbiAgICAgIHJldHVybiBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBlbC5jbGFzc05hbWUgKz0gJyAnICsgY2xhc3NOYW1lO1xuICAgIH1cbiAgfTtcblxuICBRSi5oYXNDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjbGFzc05hbWUpIHtcbiAgICB2YXIgZSwgaGFzQ2xhc3MsIGksIGxlbjtcbiAgICBpZiAoZWwubGVuZ3RoKSB7XG4gICAgICBoYXNDbGFzcyA9IHRydWU7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBlbC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBlID0gZWxbaV07XG4gICAgICAgIGhhc0NsYXNzID0gaGFzQ2xhc3MgJiYgUUouaGFzQ2xhc3MoZSwgY2xhc3NOYW1lKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBoYXNDbGFzcztcbiAgICB9XG4gICAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgICAgcmV0dXJuIGVsLmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbmV3IFJlZ0V4cCgnKF58ICknICsgY2xhc3NOYW1lICsgJyggfCQpJywgJ2dpJykudGVzdChlbC5jbGFzc05hbWUpO1xuICAgIH1cbiAgfTtcblxuICBRSi5yZW1vdmVDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjbGFzc05hbWUpIHtcbiAgICB2YXIgY2xzLCBlLCBpLCBsZW4sIHJlZiwgcmVzdWx0cztcbiAgICBpZiAoZWwubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaSwgbGVuLCByZXN1bHRzO1xuICAgICAgICByZXN1bHRzID0gW107XG4gICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGVsLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgZSA9IGVsW2ldO1xuICAgICAgICAgIHJlc3VsdHMucHVzaChRSi5yZW1vdmVDbGFzcyhlLCBjbGFzc05hbWUpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgIH0pKCk7XG4gICAgfVxuICAgIGlmIChlbC5jbGFzc0xpc3QpIHtcbiAgICAgIHJlZiA9IGNsYXNzTmFtZS5zcGxpdCgnICcpO1xuICAgICAgcmVzdWx0cyA9IFtdO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gcmVmLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNscyA9IHJlZltpXTtcbiAgICAgICAgcmVzdWx0cy5wdXNoKGVsLmNsYXNzTGlzdC5yZW1vdmUoY2xzKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJyhefFxcXFxiKScgKyBjbGFzc05hbWUuc3BsaXQoJyAnKS5qb2luKCd8JykgKyAnKFxcXFxifCQpJywgJ2dpJyksICcgJyk7XG4gICAgfVxuICB9O1xuXG4gIFFKLnRvZ2dsZUNsYXNzID0gZnVuY3Rpb24oZWwsIGNsYXNzTmFtZSwgYm9vbCkge1xuICAgIHZhciBlO1xuICAgIGlmIChlbC5sZW5ndGgpIHtcbiAgICAgIHJldHVybiAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpLCBsZW4sIHJlc3VsdHM7XG4gICAgICAgIHJlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yIChpID0gMCwgbGVuID0gZWwubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBlID0gZWxbaV07XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKFFKLnRvZ2dsZUNsYXNzKGUsIGNsYXNzTmFtZSwgYm9vbCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgfSkoKTtcbiAgICB9XG4gICAgaWYgKGJvb2wpIHtcbiAgICAgIGlmICghUUouaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkpIHtcbiAgICAgICAgcmV0dXJuIFFKLmFkZENsYXNzKGVsLCBjbGFzc05hbWUpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUUoucmVtb3ZlQ2xhc3MoZWwsIGNsYXNzTmFtZSk7XG4gICAgfVxuICB9O1xuXG4gIFFKLmFwcGVuZCA9IGZ1bmN0aW9uKGVsLCB0b0FwcGVuZCkge1xuICAgIHZhciBlO1xuICAgIGlmIChlbC5sZW5ndGgpIHtcbiAgICAgIHJldHVybiAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpLCBsZW4sIHJlc3VsdHM7XG4gICAgICAgIHJlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yIChpID0gMCwgbGVuID0gZWwubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBlID0gZWxbaV07XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKFFKLmFwcGVuZChlLCB0b0FwcGVuZCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgfSkoKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgdG9BcHBlbmQpO1xuICB9O1xuXG4gIFFKLmZpbmQgPSBmdW5jdGlvbihlbCwgc2VsZWN0b3IpIHtcbiAgICBpZiAoZWwgaW5zdGFuY2VvZiBOb2RlTGlzdCB8fCBlbCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICBlbCA9IGVsWzBdO1xuICAgIH1cbiAgICByZXR1cm4gZWwucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gIH07XG5cbiAgUUoudHJpZ2dlciA9IGZ1bmN0aW9uKGVsLCBuYW1lLCBkYXRhKSB7XG4gICAgdmFyIGUsIGVycm9yLCBldjtcbiAgICB0cnkge1xuICAgICAgZXYgPSBuZXcgQ3VzdG9tRXZlbnQobmFtZSwge1xuICAgICAgICBkZXRhaWw6IGRhdGFcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBlID0gZXJyb3I7XG4gICAgICBldiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgICAgaWYgKGV2LmluaXRDdXN0b21FdmVudCkge1xuICAgICAgICBldi5pbml0Q3VzdG9tRXZlbnQobmFtZSwgdHJ1ZSwgdHJ1ZSwgZGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBldi5pbml0RXZlbnQobmFtZSwgdHJ1ZSwgdHJ1ZSwgZGF0YSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlbC5kaXNwYXRjaEV2ZW50KGV2KTtcbiAgfTtcblxuICBtb2R1bGUuZXhwb3J0cyA9IFFKO1xuXG59KS5jYWxsKHRoaXMpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../../../../node_modules/qj/lib/index.js\n");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/js/payments/opayo.js");
/******/ 	
/******/ })()
;