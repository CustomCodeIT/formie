import{_ as u,M as h,r as f,o as m,c as g,a as s,n as i,t as l,w as d,b as p,d as _,e as M}from"./config.4d1b157c.js";const C={name:"IntegrationConnect",components:{Modal:h},props:{connected:{type:Boolean}},data(){return{statusText:"",showModal:!1,error:!1,errorMessage:"",loading:!1}},computed:{statusClass(){return this.statusText==="Error"?"off":this.statusText==="Connected"?"on":""}},created(){this.statusText=this.connected?"Connected":"Not connected"},methods:{getFormInputs(){let t=[],e=document.getElementById("main-form");return e||(e=document.getElementById("main")),e&&(t=e.querySelectorAll("input, select, textarea")),t},serializeForm(){const t={};return this.getFormInputs().forEach(e=>{const n=e.getAttribute("name");t[n]=e.value}),t},refresh(){this.showModal=!1,this.error=!1,this.errorMessage="",this.loading=!0,this.statusText="Connecting...";const t=this.serializeForm();Craft.sendActionRequest("POST","formie/integrations/check-connection",{data:t}).then(e=>{if(this.loading=!1,e.data.message){this.error=!0,this.showModal=!0,this.errorMessage=Craft.t("formie","An error occurred."),this.errorMessage+=`<br><br><code>${e.data.message}</code>`,this.statusText="Error";return}this.statusText="Connected"}).catch(e=>{this.loading=!1,this.error=!0,this.showModal=!0,this.errorMessage=e,e.response.data.message&&(this.errorMessage+=`<br><br><code>${e.response.data.message}</code>`),this.statusText="Error"})},closeModal(){this.showModal=!1}}},v={class:"field lightswitch-field"},w={class:"heading"},T={class:"input ltr"},x=["title"],b={class:"fui-error-pane error"},y={class:"fui-error-content"},k=s("span",{"data-icon":"alert"},null,-1),I=["innerHTML"];function B(t,e,n,A,r,o){const c=f("modal");return m(),g("div",v,[s("div",w,[s("span",{class:i(["status",o.statusClass])},null,2),s("span",null,l(t.t("formie",r.statusText)),1)]),s("div",T,[s("button",{class:i(["btn small",{"fui-loading fui-loading-tiny":r.loading}]),title:t.t("formie","Refresh"),onClick:e[0]||(e[0]=d((...a)=>o.refresh&&o.refresh(...a),["prevent"]))},l(t.t("formie","Refresh")),11,x),p(c,{ref:"modal",modelValue:r.showModal,"onUpdate:modelValue":e[2]||(e[2]=a=>r.showModal=a),"show-header":!1,"show-footer":!1,"modal-class":"fui-integration-error-modal",onClickOutside:o.closeModal},{body:_(()=>[s("div",{class:"fui-dialog-close",onClick:e[1]||(e[1]=d((...a)=>o.closeModal&&o.closeModal(...a),["prevent"]))}),s("div",b,[s("div",y,[k,s("span",{class:"error",innerHTML:r.errorMessage},null,8,I)])])]),_:1},8,["modelValue","onClickOutside"])])])}var E=u(C,[["render",B]]);const V=M({delimiters:["${","}"],components:{IntegrationConnect:E}});V.mount(".fui-integrations-settings #details .meta");
//# sourceMappingURL=formie-integration-settings.7b932337.js.map
