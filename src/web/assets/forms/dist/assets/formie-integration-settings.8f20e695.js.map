{"version":3,"file":"formie-integration-settings.8f20e695.js","sources":["../../plugin-vue:export-helper","../../src/js/components/Modal.vue","../../src/js/components/IntegrationConnect.vue","../../src/js/formie-integration-settings.js"],"sourcesContent":["\nexport default (sfc, props) => {\n  const target = sfc.__vccOpts || sfc;\n  for (const [key, val] of props) {\n    target[key] = val;\n  }\n  return target;\n}\n","<template>\n    <portal :to=\"to\">\n        <transition name=\"fui-modal-fade\">\n            <div v-if=\"created\" class=\"modal-shade fui-modal-shade\" :class=\"{ hidden: !visible }\">\n                <div class=\"fui-modal-shade-close\" @click.prevent=\"hideModal\"></div>\n\n                <div class=\"modal fui-modal\" :class=\"[modalClass, { 'has-header': showHeader, 'has-footer': showFooter }]\" role=\"dialog\" aria-labelledby=\"modalTitle\" aria-describedby=\"modalDescription\">\n                    <header v-if=\"showHeader\" id=\"modalTitle\" class=\"fui-modal-header\">\n                        <slot name=\"header\"></slot>\n                    </header>\n\n                    <section id=\"modalDescription\" class=\"fui-modal-body\">\n                        <slot name=\"body\"></slot>\n                    </section>\n\n                    <footer v-if=\"showFooter\" class=\"footer fui-modal-footer\">\n                        <slot name=\"footer\"></slot>\n                    </footer>\n\n                    <div class=\"resizehandle\"></div>\n                </div>\n            </div>\n        </transition>\n    </portal>\n</template>\n\n<script>\n\nexport default {\n    name: 'Modal',\n\n    props: {\n        to: {\n            type: String,\n            default: 'modals',\n        },\n\n        modalClass: {\n            type: [String, Array],\n            default: '',\n        },\n\n        isVisible: {\n            type: Boolean,\n            default: false,\n        },\n\n        showHeader: {\n            type: Boolean,\n            default: true,\n        },\n\n        showFooter: {\n            type: Boolean,\n            default: true,\n        },\n    },\n\n    data() {\n        return {\n            created: false,\n            visible: false,\n        };\n    },\n\n    mounted() {\n        // Allow props to set the state immediately\n        if (this.isVisible) {\n            this.visible = true;\n            this.created = true;\n        }\n    },\n\n    methods: {\n        showModal() {\n            this.visible = true;\n            this.created = true;\n        },\n\n        hideModal() {\n            this.created = false;\n            this.visible = false;\n\n            this.$emit('close');\n        },\n\n        createModal() {\n            // Control the rendered state of this modal. We sometimes want to trigger the rendering of content\n            // for things like form validation, which won't work if the contents are hidden with v-if.\n            // This method is usually called before validation.\n            this.created = true;\n\n            // Return a promise for the next DOM update, now that created has been set. This will take a little\n            // bit of effort the first time, for larger fields, but will be much faster the next round.\n            // We can listen on the callback to know when we're done with the render.\n            return this.$nextTick();\n        },\n\n        destroyModal() {\n            this.created = false;\n            this.visible = false;\n\n            this.$emit('destroy');\n        },\n    },\n};\n\n</script>\n\n<style lang=\"scss\">\n\n.fui-modal-fade-enter,\n.fui-modal-fade-leave-active {\n    opacity: 0;\n}\n\n.fui-modal-fade-enter-active,\n.fui-modal-fade-leave-active {\n    transition: opacity 0.3s ease;\n}\n\n.fui-modal-shade {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.fui-modal-shade-close {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fui-modal-header {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    background-color: #f3f7fc;\n    box-shadow: inset 0 -1px 0 rgba(51, 64, 77, 0.1);\n    padding: 10px 24px;\n    display: flex;\n    align-items: center;\n}\n\n.fui-modal-title {\n    margin: 0;\n    padding: 0;\n    font-weight: 600;\n    font-size: 15px;\n    line-height: 30px;\n}\n\n.fui-dialog-close {\n    width: 20px;\n    height: 20px;\n    margin-left: auto;\n    cursor: pointer;\n    background-size: 20px 20px;\n    background-repeat: no-repeat;\n    transition: all 0.3s ease;\n    background-image: url(\"data:image/svg+xml,%3Csvg aria-hidden='true' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3Cpath fill='%233f4d5a' d='M207.6 256l107.72-107.72c6.23-6.23 6.23-16.34 0-22.58l-25.03-25.03c-6.23-6.23-16.34-6.23-22.58 0L160 208.4 52.28 100.68c-6.23-6.23-16.34-6.23-22.58 0L4.68 125.7c-6.23 6.23-6.23 16.34 0 22.58L112.4 256 4.68 363.72c-6.23 6.23-6.23 16.34 0 22.58l25.03 25.03c6.23 6.23 16.34 6.23 22.58 0L160 303.6l107.72 107.72c6.23 6.23 16.34 6.23 22.58 0l25.03-25.03c6.23-6.23 6.23-16.34 0-22.58L207.6 256z'%3E%3C/path%3E%3C/svg%3E\");\n    opacity: 0.6;\n\n    &:hover {\n        opacity: 1;\n    }\n}\n\n.fui-modal-body {\n    height: 100%;\n    position: relative;\n    overflow: auto;\n}\n\n.has-header .fui-modal-body {\n    top: 50px;\n    height: calc(100% - 62px);\n}\n\n.has-header.has-footer .fui-modal-body {\n    height: calc(100% - 112px);\n}\n\n.fui-modal-content {\n    padding: 24px;\n}\n\n.fui-modal-footer {\n    bottom: 0;\n    left: 0;\n    margin: 0;\n    position: absolute;\n    width: 100%;\n}\n\n</style>\n","<template>\n    <div class=\"field lightswitch-field\">\n        <div class=\"heading\">\n            <span class=\"status\" :class=\"statusClass\"></span>\n            <span>{{ t('formie', statusText) }}</span>\n        </div>\n\n        <div class=\"input ltr\">\n            <button class=\"btn small\" :class=\"{ 'fui-loading fui-loading-tiny': loading }\" title=\"$options.filters.t('Refresh', 'formie')\" @click.prevent=\"refresh\">{{ t('formie', 'Refresh') }}</button>\n\n            <modal ref=\"modal\" to=\"integrations-modals\" :show-header=\"false\" :show-footer=\"false\" modal-class=\"fui-integration-error-modal\">\n                <template v-slot:body>\n                    <div class=\"fui-dialog-close\" @click.prevent=\"hideModal\"></div>\n\n                    <div class=\"fui-error-pane error\">\n                        <div class=\"fui-error-content\">\n                            <span data-icon=\"alert\"></span>\n\n                            <span class=\"error\" v-html=\"errorMessage\"></span>\n                        </div>\n                    </div>\n                </template>\n            </modal>\n        </div>\n    </div>\n</template>\n\n<script>\nimport Modal from '@components/Modal.vue';\n\nexport default {\n    name: 'IntegrationConnect',\n\n    components: {\n        Modal,\n    },\n\n    props: {\n        connected: {\n            type: Boolean,\n        },\n    },\n\n    data() {\n        return {\n            statusText: '',\n            error: false,\n            errorMessage: '',\n            loading: false,\n        };\n    },\n\n    computed: {\n        statusClass() {\n            if (this.statusText === 'Error') {\n                return 'off';\n            }\n\n            if (this.statusText === 'Connected') {\n                return 'on';\n            }\n\n            return '';\n        },\n    },\n\n    created() {\n        this.statusText = this.connected ? 'Connected' : 'Not connected';\n    },\n\n    methods: {\n        getFormInputs() {\n            var inputs = [];\n\n            // Serialize the integration pane\n            var $form = document.getElementById('main-form');\n\n            // Check for when `allowAdminChanges = false` on production - no form\n            if (!$form) {\n                $form = document.getElementById('main');\n            }\n\n            if ($form) {\n                inputs = $form.querySelectorAll('input, select, textarea');\n            }\n\n            return inputs;\n        },\n\n        serializeForm() {\n            var values = {};\n\n            this.getFormInputs().forEach($inputElement => {\n                var attribute = $inputElement.getAttribute('name');\n\n                values[attribute] = $inputElement.value;\n            });\n\n            return values;\n        },\n\n        refresh() {\n            this.error = false;\n            this.errorMessage = '';\n            this.loading = true;\n            this.statusText = 'Connecting...';\n\n            const data = this.serializeForm();\n\n            Craft.sendActionRequest('POST', 'formie/integrations/check-connection', { data })\n                .then((response) => {\n                    this.loading = false;\n\n                    if (response.data.message) {\n                        this.error = true;\n                        this.$refs.modal.showModal();\n\n                        this.errorMessage = this.$options.filters.t('An error occurred.', 'formie');\n                        this.errorMessage += '<br><br><code>' + response.data.message + '</code>';\n\n                        this.statusText = 'Error';\n\n                        return;\n                    }\n\n                    this.statusText = 'Connected';\n                }).catch(error => {\n                    this.loading = false;\n                    this.error = true;\n                    this.$refs.modal.showModal();\n\n                    this.errorMessage = error;\n\n                    if (error.response.data.message) {\n                        this.errorMessage += '<br><br><code>' + error.response.data.message + '</code>';\n                    }\n\n                    this.statusText = 'Error';\n                });\n        },\n\n        hideModal() {\n            this.$refs.modal.hideModal();\n        },\n    },\n\n};\n\n</script>\n\n<style lang=\"scss\">\n\n.fui-integrations-settings {\n    .modal {\n        position: absolute;\n        width: 45%;\n        height: 350px;\n        min-width: 600px;\n        min-height: auto;\n        box-shadow: 0 0 20px rgba(63, 77, 90, 0.1);\n        border: 1px solid #cdd8e4;\n        border-radius: 10px;\n    }\n}\n\n.fui-integration-error-modal .fui-dialog-close {\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    z-index: 3;\n}\n\n.fui-integration-error-modal .fui-error-pane {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    z-index: 1;\n}\n\n.fui-integration-error-modal .fui-error-pane {\n    align-items: center;\n    justify-content: center;\n    display: flex;\n\n    [data-icon] {\n        display: block;\n        font-size: 3em;\n        margin-bottom: 0.5rem;\n    }\n}\n\n.fui-integration-error-modal .fui-error-content {\n    text-align: center;\n    width: 90%;\n}\n\n\n</style>\n","import { createVueApp } from './config';\n\nimport IntegrationConnect from '@components/IntegrationConnect.vue';\n\nconst app = createVueApp({\n    // Set the delimeters to not mess around with Twig\n    delimiters: ['${', '}'],\n\n    components: {\n        IntegrationConnect,\n    },\n});\n\napp.mount('.fui-integrations-settings #details .meta');"],"names":["_sfc_main","_createElementVNode","_createBlock","_createVNode","_Transition","_createElementBlock","_normalizeClass","_openBlock","_hoisted_1","_renderSlot","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString"],"mappings":"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"}