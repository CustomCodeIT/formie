import{r as v,o as n,c as M,w as m,a as p,b as l,d as s,e as _,f as u,g as f,n as d,T as b,t as g,h as C}from"./config.1df77d19.js";var y=(t,e)=>{const o=t.__vccOpts||t;for(const[c,a]of e)o[c]=a;return o};const T={name:"Modal",props:{to:{type:String,default:"modals"},modalClass:{type:[String,Array],default:""},isVisible:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!0}},data(){return{created:!1,visible:!1}},mounted(){this.isVisible&&(this.visible=!0,this.created=!0)},methods:{showModal(){this.visible=!0,this.created=!0},hideModal(){this.created=!1,this.visible=!1,this.$emit("close")},createModal(){return this.created=!0,this.$nextTick()},destroyModal(){this.created=!1,this.visible=!1,this.$emit("destroy")}}},w={key:0,id:"modalTitle",class:"fui-modal-header"},k={id:"modalDescription",class:"fui-modal-body"},x={key:1,class:"footer fui-modal-footer"},B=s("div",{class:"resizehandle"},null,-1);function $(t,e,o,c,a,r){const h=v("portal");return n(),M(h,{to:o.to},{default:m(()=>[p(b,{name:"fui-modal-fade"},{default:m(()=>[a.created?(n(),l("div",{key:0,class:d(["modal-shade fui-modal-shade",{hidden:!a.visible}])},[s("div",{class:"fui-modal-shade-close",onClick:e[0]||(e[0]=_((...i)=>r.hideModal&&r.hideModal(...i),["prevent"]))}),s("div",{class:d(["modal fui-modal",[o.modalClass,{"has-header":o.showHeader,"has-footer":o.showFooter}]]),role:"dialog","aria-labelledby":"modalTitle","aria-describedby":"modalDescription"},[o.showHeader?(n(),l("header",w,[u(t.$slots,"header")])):f("",!0),s("section",k,[u(t.$slots,"body")]),o.showFooter?(n(),l("footer",x,[u(t.$slots,"footer")])):f("",!0),B],2)],2)):f("",!0)]),_:3})]),_:3},8,["to"])}var F=y(T,[["render",$]]);const I={name:"IntegrationConnect",components:{Modal:F},props:{connected:{type:Boolean}},data(){return{statusText:"",error:!1,errorMessage:"",loading:!1}},computed:{statusClass(){return this.statusText==="Error"?"off":this.statusText==="Connected"?"on":""}},created(){this.statusText=this.connected?"Connected":"Not connected"},methods:{getFormInputs(){var t=[],e=document.getElementById("main-form");return e||(e=document.getElementById("main")),e&&(t=e.querySelectorAll("input, select, textarea")),t},serializeForm(){var t={};return this.getFormInputs().forEach(e=>{var o=e.getAttribute("name");t[o]=e.value}),t},refresh(){this.error=!1,this.errorMessage="",this.loading=!0,this.statusText="Connecting...";const t=this.serializeForm();Craft.sendActionRequest("POST","formie/integrations/check-connection",{data:t}).then(e=>{if(this.loading=!1,e.data.message){this.error=!0,this.$refs.modal.showModal(),this.errorMessage=this.$options.filters.t("An error occurred.","formie"),this.errorMessage+="<br><br><code>"+e.data.message+"</code>",this.statusText="Error";return}this.statusText="Connected"}).catch(e=>{this.loading=!1,this.error=!0,this.$refs.modal.showModal(),this.errorMessage=e,e.response.data.message&&(this.errorMessage+="<br><br><code>"+e.response.data.message+"</code>"),this.statusText="Error"})},hideModal(){this.$refs.modal.hideModal()}}},A={class:"field lightswitch-field"},E={class:"heading"},S={class:"input ltr"},V={class:"fui-error-pane error"},H={class:"fui-error-content"},z=s("span",{"data-icon":"alert"},null,-1),N=["innerHTML"];function D(t,e,o,c,a,r){const h=v("modal");return n(),l("div",A,[s("div",E,[s("span",{class:d(["status",r.statusClass])},null,2),s("span",null,g(t.t("formie",a.statusText)),1)]),s("div",S,[s("button",{class:d(["btn small",{"fui-loading fui-loading-tiny":a.loading}]),title:"$options.filters.t('Refresh', 'formie')",onClick:e[0]||(e[0]=_((...i)=>r.refresh&&r.refresh(...i),["prevent"]))},g(t.t("formie","Refresh")),3),p(h,{ref:"modal",to:"integrations-modals","show-header":!1,"show-footer":!1,"modal-class":"fui-integration-error-modal"},{body:m(()=>[s("div",{class:"fui-dialog-close",onClick:e[1]||(e[1]=_((...i)=>r.hideModal&&r.hideModal(...i),["prevent"]))}),s("div",V,[s("div",H,[z,s("span",{class:"error",innerHTML:a.errorMessage},null,8,N)])])]),_:1},512)])])}var R=y(I,[["render",D]]);const q=C({delimiters:["${","}"],components:{IntegrationConnect:R}});q.mount(".fui-integrations-settings #details .meta");
//# sourceMappingURL=formie-integration-settings.8f20e695.js.map
